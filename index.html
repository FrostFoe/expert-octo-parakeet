<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta
      name="description"
      content="‡¶™‡¶∞‡ßÄ‡¶ï‡ßç‡¶∑‡¶æ ‡¶®‡¶ø‡¶Ø‡¶º‡¶®‡ßç‡¶§‡ßç‡¶∞‡¶ï - ‡¶è‡¶ï‡¶ü‡¶ø ‡¶Ü‡¶ß‡ßÅ‡¶®‡¶ø‡¶ï ‡¶è‡¶¨‡¶Ç ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞‡¶ï‡¶æ‡¶∞‡ßÄ-‡¶¨‡¶æ‡¶®‡ßç‡¶ß‡¶¨ ‡¶™‡¶∞‡ßÄ‡¶ï‡ßç‡¶∑‡¶æ ‡¶™‡¶∞‡¶ø‡¶ö‡¶æ‡¶≤‡¶®‡¶æ ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶™‡ßç‡¶≤‡¶ø‡¶ï‡ßá‡¶∂‡¶®‡•§ ‡¶∏‡ßç‡¶¨‡¶Ø‡¶º‡¶Ç‡¶ï‡ßç‡¶∞‡¶ø‡¶Ø‡¶º ‡¶ü‡¶æ‡¶á‡¶Æ‡¶æ‡¶∞, ‡¶®‡ßá‡¶ó‡ßá‡¶ü‡¶ø‡¶≠ ‡¶Æ‡¶æ‡¶∞‡ßç‡¶ï‡¶ø‡¶Ç ‡¶è‡¶¨‡¶Ç ‡¶¨‡¶ø‡¶∏‡ßç‡¶§‡¶æ‡¶∞‡¶ø‡¶§ ‡¶´‡¶≤‡¶æ‡¶´‡¶≤ ‡¶¨‡¶ø‡¶∂‡ßç‡¶≤‡ßá‡¶∑‡¶£ ‡¶∏‡¶π‡•§"
    />
    <meta
      name="keywords"
      content="‡¶™‡¶∞‡ßÄ‡¶ï‡ßç‡¶∑‡¶æ, MCQ, ‡¶™‡¶∞‡ßÄ‡¶ï‡ßç‡¶∑‡¶æ ‡¶®‡¶ø‡¶Ø‡¶º‡¶®‡ßç‡¶§‡ßç‡¶∞‡¶ï, Be Examiner, ‡¶∂‡¶ø‡¶ï‡ßç‡¶∑‡¶æ, ‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ"
    />
    <meta name="author" content="Be Examiner Team" />
    <title>
      ‡¶™‡¶∞‡ßÄ‡¶ï‡ßç‡¶∑‡¶æ ‡¶®‡¶ø‡¶Ø‡¶º‡¶®‡ßç‡¶§‡ßç‡¶∞‡¶ï - Be Examiner | ‡¶Ü‡¶ß‡ßÅ‡¶®‡¶ø‡¶ï ‡¶™‡¶∞‡ßÄ‡¶ï‡ßç‡¶∑‡¶æ ‡¶™‡¶∞‡¶ø‡¶ö‡¶æ‡¶≤‡¶®‡¶æ ‡¶∏‡¶ø‡¶∏‡ßç‡¶ü‡ßá‡¶Æ
    </title>
    <link
      rel="icon"
      type="image/x-icon"
      href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üìö</text></svg>"
    />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Hind+Siliguri:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <!-- Load Font Awesome from CDN -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css"
      integrity="sha512-Kc323vGBEqzTmouAECnVceyQqyqdsSiqLQISBL29aUW4U/M7pSPA/gEUZQqv1cwx4OnYxTxve5UMg5GT6L4JJg=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    />
    <!-- Load Tailwind from CDN (play CDN for dev/prototyping) -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
      tailwind.config = {
        theme: {
          extend: {
            fontFamily: {
              hind: ["Hind Siliguri", "sans-serif"],
            },
            backgroundImage: {
              "gradient-primary":
                "linear-gradient(135deg, #667eea 0%, #764ba2 100%)",
              "gradient-secondary":
                "linear-gradient(135deg, #a8edea 0%, #fed6e3 100%)",
              "gradient-accent":
                "linear-gradient(135deg, #ff9a9e 0%, #fecfef 100%)",
            },
          },
        },
      };
    </script>
    <style>
      .glass-morphism {
        backdrop-filter: blur(10px);
        -webkit-backdrop-filter: blur(10px);
      }

      .glass-morphism-strong {
        backdrop-filter: blur(15px);
        -webkit-backdrop-filter: blur(15px);
      }

      .text-gradient {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
      }

      /* Enhanced Mobile Touch Interaction */
      .radio-custom {
        -webkit-tap-highlight-color: transparent;
        touch-action: manipulation;
      }

      .radio-custom::before {
        content: attr(value);
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        font-weight: bold;
        pointer-events: none;
        transition: all 0.2s ease;
      }

      /* Mobile-first responsive design improvements */
      @media screen and (max-width: 640px) {
        .mobile-stack {
          flex-direction: column !important;
        }

        .mobile-full-width {
          width: 100% !important;
        }

        .mobile-text-sm {
          font-size: 0.875rem !important;
        }

        .mobile-p-2 {
          padding: 0.5rem !important;
        }

        .mobile-gap-2 {
          gap: 0.5rem !important;
        }

        /* Enhanced touch targets for mobile */
        .touch-target {
          min-height: 48px !important;
          min-width: 48px !important;
        }

        /* Better button spacing on mobile */
        .mobile-button-spacing {
          margin: 0.5rem 0 !important;
        }

        /* Improved form fields on mobile */
        .mobile-form-field {
          padding: 12px 16px !important;
          font-size: 16px !important; /* Prevents zoom on iOS */
        }

        /* Better MCQ layout on mobile */
        .mobile-mcq-option {
          margin: 8px 0 !important;
          padding: 12px !important;
          border-radius: 12px !important;
        }

        /* Floating elements positioning for mobile */
        .mobile-floating-bottom {
          bottom: 20px !important;
          left: 20px !important;
          right: 20px !important;
        }

        /* Better summary positioning on mobile */
        .mobile-summary-position {
          bottom: 80px !important;
          left: 10px !important;
          right: 10px !important;
          width: auto !important;
          max-width: none !important;
        }
      }

      /* Touch device optimizations */
      @media (hover: none) and (pointer: coarse) {
        .touch-optimize {
          -webkit-tap-highlight-color: rgba(0, 0, 0, 0.1);
          user-select: none;
          -webkit-user-select: none;
        }

        /* Larger touch targets */
        button,
        .cursor-pointer,
        input[type="radio"],
        input[type="checkbox"] {
          min-height: 44px;
          min-width: 44px;
        }

        /* Better spacing for touch */
        .touch-spacing {
          margin: 8px 0;
        }
      }

      /* Landscape phone optimizations */
      @media screen and (max-height: 500px) and (orientation: landscape) {
        .landscape-compact {
          padding: 0.25rem !important;
          font-size: 0.75rem !important;
        }

        .landscape-hide {
          display: none !important;
        }

        /* Compact timer in landscape */
        #timer-compact {
          font-size: 0.875rem !important;
          padding: 0.25rem 0.5rem !important;
        }

        /* Smaller floating summary in landscape */
        #summary-content {
          max-height: 30vh !important;
          width: 200px !important;
        }
      }

      /* Tablet-specific optimizations */
      @media screen and (min-width: 641px) and (max-width: 1024px) {
        .tablet-columns {
          display: grid !important;
          grid-template-columns: repeat(2, 1fr) !important;
          gap: 1rem !important;
        }

        .tablet-spacing {
          padding: 1rem !important;
          margin: 0.75rem 0 !important;
        }
      }

      /* High DPI screen optimizations */
      @media (-webkit-min-device-pixel-ratio: 2), (min-resolution: 2dppx) {
        .icon-sharp {
          transform: translateZ(0);
          -webkit-font-smoothing: antialiased;
        }
      }

      /* Dark mode preparation for mobile */
      @media (prefers-color-scheme: dark) {
        .dark-mode-ready {
          color-scheme: light; /* Force light mode for now */
        }
      }

      /* Reduced motion for accessibility */
      @media (prefers-reduced-motion: reduce) {
        * {
          animation-duration: 0.01ms !important;
          animation-iteration-count: 1 !important;
          transition-duration: 0.01ms !important;
        }
      }

      /* Print styles */
      @media print {
        .no-print {
          display: none !important;
        }

        .print-break-inside-avoid {
          break-inside: avoid;
          page-break-inside: avoid;
        }
      }

      .radio-custom:checked {
        background-color: #667eea;
        border-color: #667eea;
      }

      .radio-custom:checked::before {
        color: white;
      }

      .checkbox-custom::after {
        content: "\f00c";
        font-family: "Font Awesome 6 Free";
        font-weight: 900;
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        color: white;
        font-size: 12px;
      }

      input[type="checkbox"]:checked + span {
        background-color: #667eea;
        border-color: #667eea;
      }

      input[type="checkbox"]:checked + span::after {
        content: "\f00c";
        font-family: "Font Awesome 6 Free";
        font-weight: 900;
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        color: white;
        font-size: 12px;
      }

      .timer-icon::before {
        content: "\f017";
        font-family: "Font Awesome 6 Free";
        font-weight: 900;
        margin-right: 8px;
      }

      @keyframes spin {
        0% {
          transform: rotate(0deg);
        }

        100% {
          transform: rotate(360deg);
        }
      }

      .loading-spinner::after {
        content: "";
        position: absolute;
        top: 50%;
        left: 50%;
        width: 20px;
        height: 20px;
        margin: -10px 0 0 -10px;
        border: 2px solid transparent;
        border-top: 2px solid #667eea;
        border-radius: 50%;
        animation: spin 1s linear infinite;
      }

      @media (max-width: 640px) {
        body {
          padding: 0.25rem;
        }

        #floating-summary {
          bottom: 0.75rem;
          right: 0.75rem;
          left: auto;
          width: 2.5rem;
          height: 2.5rem;
        }

        #floating-summary i {
          font-size: 0.875rem;
        }

        #summary-content {
          bottom: 3rem !important;
          left: 0.75rem !important;
          width: 120px !important;
          max-height: 120px !important;
          z-index: 9999 !important;
        }

        #timer {
          position: sticky;
          top: 0;
          z-index: 100;
          margin-bottom: 0.75rem;
          padding: 0.5rem;
          font-size: 0.875rem;
          border-radius: 0.5rem;
        }

        .mb-4 {
          margin-bottom: 1rem;
        }

        .mb-6 {
          margin-bottom: 1.5rem;
        }

        .mr-4 {
          margin-right: 0.5rem;
        }

        .mcq-container .flex {
          flex-direction: column;
          align-items: flex-start;
        }

        .mcq-container .flex-1 {
          width: 100%;
          margin-bottom: 0.5rem;
        }

        .mcq-container .flex-wrap {
          justify-content: center;
          gap: 0.25rem;
        }

        .radio-custom {
          width: 1.5rem;
          height: 1.5rem;
          margin: 0.125rem;
        }

        .grid-cols-6 {
          grid-template-columns: repeat(2, 1fr);
          gap: 0.5rem;
        }

        .grid-cols-6 > div:nth-child(n + 5) {
          grid-column: span 2;
        }

        .grid-cols-4 {
          grid-template-columns: repeat(2, 1fr);
          gap: 0.5rem;
        }

        .text-center .inline-flex {
          display: block;
          width: 100%;
          margin-bottom: 0.25rem;
        }

        .text-center .inline-flex:last-child {
          margin-bottom: 0;
        }
      }

      @media (min-width: 641px) and (max-width: 768px) {
        #floating-summary {
          bottom: 1.5rem;
          left: 1.5rem;
        }

        .grid-cols-6 {
          grid-template-columns: repeat(3, 1fr);
        }

        .grid-cols-4 {
          grid-template-columns: repeat(2, 1fr);
        }
      }

      @media (min-width: 769px) and (max-width: 1024px) {
        .grid-cols-6 {
          grid-template-columns: repeat(4, 1fr);
        }

        .grid-cols-6 > div:last-child {
          grid-column: span 2;
        }
      }

      @media (min-width: 1025px) {
        .max-w-\[900px\] {
          max-width: 1000px;
        }

        .grid-cols-6 {
          grid-template-columns: repeat(6, 1fr);
        }
      }

      @media print {
        body * {
          visibility: hidden;
        }

        #result-section,
        #result-section * {
          visibility: visible;
        }

        #result-section {
          position: absolute;
          left: 0;
          top: 0;
        }

        .no-print {
          display: none !important;
        }
      }

      .sr-only {
        position: absolute;
        width: 1px;
        height: 1px;
        padding: 0;
        margin: -1px;
        overflow: hidden;
        clip: rect(0, 0, 0, 0);
        white-space: nowrap;
        border: 0;
      }

      button:focus-visible,
      input:focus-visible,
      select:focus-visible,
      textarea:focus-visible {
        outline: 2px solid #667eea;
        outline-offset: 2px;
      }

      @media (hover: none) and (pointer: coarse) {
        .radio-custom {
          width: 2.5rem;
          height: 2.5rem;
        }

        button {
          min-height: 44px;
          padding: 0.75rem 1rem;
        }

        #floating-summary {
          width: 4rem;
          height: 4rem;
        }
      }

      @media (prefers-contrast: high) {
        .glass-morphism {
          backdrop-filter: none;
          background: rgba(255, 255, 255, 0.95);
          border: 1px solid #000;
        }

        .text-gradient {
          background: none;
          color: #000;
          -webkit-text-fill-color: #000;
        }
      }

      @media (prefers-reduced-motion: reduce) {
        * {
          animation-duration: 0.01ms !important;
          animation-iteration-count: 1 !important;
          transition-duration: 0.01ms !important;
        }
      }

      .break-words {
        word-wrap: break-word;
        overflow-wrap: break-word;
      }

      @media (max-width: 640px) {
        html {
          scroll-behavior: smooth;
        }

        body {
          -webkit-overflow-scrolling: touch;
        }
      }

      #summary-content {
        position: fixed !important;
        background: rgba(255, 255, 255, 0.95) !important;
        backdrop-filter: blur(4px) !important;
        -webkit-backdrop-filter: blur(4px) !important;
        border: 2px solid #10b981 !important;
        border-radius: 8px !important;
        box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1) !important;
        z-index: 9999 !important;
        max-height: 160px !important;
        overflow-y: auto !important;
        padding: 6px !important;
      }

      #summary-content > div {
        display: inline-block !important;
        width: 20px !important;
        height: 20px !important;
        margin: 1px !important;
        border: 1px solid #d1d5db !important;
        text-align: center !important;
        line-height: 18px !important;
        cursor: pointer !important;
        border-radius: 4px !important;
        font-weight: bold !important;
        font-size: 10px !important;
        transition: all 0.3s ease !important;
        background-color: #e5e7eb !important;
        color: #374151 !important;
      }

      @media (min-width: 640px) {
        #summary-content {
          max-height: 192px !important;
          padding: 8px !important;
        }

        #summary-content > div {
          width: 24px !important;
          height: 24px !important;
          margin: 2px !important;
          line-height: 22px !important;
          font-size: 12px !important;
          border-radius: 6px !important;
        }
      }

      #summary-content > div:hover {
        transform: scale(1.1) !important;
      }

      #summary-content > div.bg-green-500 {
        background-color: #10b981 !important;
        color: white !important;
      }

      /* Professional animations and effects */
      /* Simplified, subtle animations for a calmer UI */
      @keyframes fadeInUp {
        from { opacity: 0; transform: translateY(8px); }
        to { opacity: 1; transform: translateY(0); }
      }

      /* Remove pulsing glow - replace with subtle opacity change */
      @keyframes subtlePulse {
        0% { opacity: 0.95; }
        50% { opacity: 1; }
        100% { opacity: 0.95; }
      }

      @keyframes slideInRight {
        from { opacity: 0; transform: translateX(12px); }
        to { opacity: 1; transform: translateX(0); }
      }

      /* Professional button effects */
      .btn-professional {
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        position: relative;
        overflow: hidden;
      }

      .btn-professional::before {
        content: "";
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(
          90deg,
          transparent,
          rgba(255, 255, 255, 0.2),
          transparent
        );
        transition: left 0.5s;
      }

      .btn-professional:hover::before {
        left: 100%;
      }

      .btn-professional:hover {
        transform: translateY(-2px);
        box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15);
      }

      .btn-professional:active {
        transform: translateY(0);
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
      }

      /* Enhanced visual feedback */
      .status-indicator {
        display: inline-block;
        width: 8px;
        height: 8px;
        border-radius: 50%;
        margin-right: 8px;
        animation: subtlePulse 2.2s infinite;
      }

      .status-success {
        background-color: #10b981;
      }
      .status-warning {
        background-color: #f59e0b;
      }
      .status-error {
        background-color: #ef4444;
      }
      .status-info {
        background-color: #3b82f6;
      }

      /* Professional scrollbars */
      ::-webkit-scrollbar {
        width: 8px;
        height: 8px;
      }

      ::-webkit-scrollbar-track {
        background: #f1f5f9;
        border-radius: 10px;
      }

      ::-webkit-scrollbar-thumb {
        background: linear-gradient(45deg, #3b82f6, #1d4ed8);
        border-radius: 10px;
        transition: all 0.3s ease;
      }

      ::-webkit-scrollbar-thumb:hover {
        background: linear-gradient(45deg, #1d4ed8, #1e40af);
      }

      /* Loading states */
      .loading-shimmer {
        background: linear-gradient(90deg, #f5f5f5 0%, #f0f0f0 50%, #f5f5f5 100%);
        background-size: 150% 100%;
        animation: loading-shimmer 0.9s linear infinite;
      }

      @keyframes loading-shimmer {
        0% { background-position: -150% 0; }
        100% { background-position: 150% 0; }
      }

      /* Professional input focus states */
      .input-professional:focus {
        outline: none;
        border-color: #3b82f6;
        box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        transform: scale(1.02);
      }

      /* Enhanced card effects */
      .card-hover {
        transition: transform 0.22s ease, box-shadow 0.22s ease;
      }

      .card-hover:hover {
        transform: translateY(-4px);
        box-shadow: 0 10px 20px rgba(0, 0, 0, 0.06);
      }

      /* Professional progress indicators */
      .progress-ring {
        transform: rotate(-90deg);
      }

      .progress-ring circle {
        transition: stroke-dashoffset 0.5s cubic-bezier(0.4, 0, 0.2, 1);
      }

      /* Enhanced notification styles */

      .notification-slide {
        animation: slideInRight 0.28s ease;
      }

      .notification-slide.hide {
        animation: slideOutRight 0.18s ease;
      }

      @keyframes slideOutRight {
        to {
          opacity: 0;
          transform: translateX(100px);
        }
      }
    </style>
  </head>

  <body
    class="font-hind m-0 min-h-screen bg-gradient-to-br from-blue-50 via-white to-indigo-50 text-gray-800 text-base leading-relaxed antialiased subpixel-antialiased"
  >
    <!-- App Header -->
    <header
      class="bg-white shadow-lg border-b border-gray-200 sticky top-0 z-50"
    >
      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="flex justify-between items-center py-4">
          <div class="flex items-center space-x-3">
            <div class="bg-gradient-primary p-2 rounded-lg">
              <i class="fas fa-graduation-cap text-white text-xl"></i>
            </div>
            <div>
              <h1 class="text-xl sm:text-2xl font-bold text-gradient font-hind">
                ‡¶™‡¶∞‡ßÄ‡¶ï‡ßç‡¶∑‡¶æ ‡¶®‡¶ø‡¶Ø‡¶º‡¶®‡ßç‡¶§‡ßç‡¶∞‡¶ï
              </h1>
              <p class="text-sm text-gray-600 font-hind">Be Examiner</p>
            </div>
          </div>
          <div class="hidden sm:flex items-center space-x-4">
            <div class="text-sm text-gray-600">
              <i class="fas fa-clock mr-1"></i>
              <span id="current-time"></span>
            </div>
            <div class="text-sm text-gray-600">
              <i class="fas fa-calendar mr-1"></i>
              <span id="current-date"></span>
            </div>
          </div>
        </div>
      </div>
    </header>

    <a
      href="#main-content"
      class="sr-only focus:not-sr-only focus:absolute focus:top-6 focus:left-6 bg-blue-600 text-white px-4 py-2 rounded-lg shadow-lg z-50 font-hind"
    >
      ‡¶Æ‡ßÇ‡¶≤ ‡¶ï‡¶®‡ßç‡¶ü‡ßá‡¶®‡ßç‡¶ü‡ßá ‡¶Ø‡¶æ‡¶®
    </a>

    <main id="main-content" class="flex-1">
      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6 sm:py-8 lg:py-12">
        <section
          id="configuration-section"
          class="bg-white/95 backdrop-blur-sm rounded-xl sm:rounded-2xl shadow-xl border border-white/30 mb-6 sm:mb-8 lg:mb-12"
          role="main"
          aria-labelledby="config-heading"
        >
          <div class="p-4 sm:p-6 lg:p-8">
            <h1
              id="config-heading"
              class="text-center text-gray-800 text-2xl sm:text-3xl md:text-4xl font-semibold mb-6 md:mb-8 text-gradient font-hind"
            >
              <i class="fas fa-cog text-gradient mr-2.5" aria-hidden="true"></i>
              ‡¶™‡¶∞‡ßÄ‡¶ï‡ßç‡¶∑‡¶æ‡¶∞ ‡¶∏‡ßá‡¶ü‡¶ø‡¶Ç‡¶∏
            </h1>
            <form
              id="test-form"
              role="form"
              aria-label="Test configuration form"
            >
              <div class="mb-4 sm:mb-6">
                <label
                  for="test-name"
                  class="block mb-2 font-medium text-gray-700 text-sm sm:text-base font-hind"
                  ><i
                    class="fas fa-file-signature text-blue-600 mr-2 w-4"
                    aria-hidden="true"
                  ></i>
                  ‡¶™‡¶∞‡ßÄ‡¶ï‡ßç‡¶∑‡¶æ‡¶∞ ‡¶®‡¶æ‡¶Æ:</label
                >
                <div class="relative">
                  <input
                    type="text"
                    id="test-name"
                    name="test-name"
                    required
                    placeholder="‡¶™‡¶∞‡ßÄ‡¶ï‡ßç‡¶∑‡¶æ‡¶∞ ‡¶®‡¶æ‡¶Æ ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶®"
                    class="w-full px-3 py-2 sm:px-4 sm:py-3 border-2 border-white/30 rounded-xl bg-white/80 glass-morphism text-sm sm:text-base transition-all duration-300 focus:outline-none focus:border-blue-600 focus:shadow-lg focus:shadow-blue-600/30 focus:-translate-y-0.5 font-hind mobile-form-field touch-target"
                    aria-describedby="test-name-help"
                  />
                  <div id="test-name-help" class="sr-only">
                    Enter the name for your exam
                  </div>
                </div>
              </div>
              <div class="mb-4 sm:mb-6">
                <label
                  for="mcq-number"
                  class="block mb-2 font-medium text-gray-700 text-sm sm:text-base font-hind"
                  ><i
                    class="fas fa-list-ol text-blue-600 mr-2 w-4"
                    aria-hidden="true"
                  ></i>
                  MCQ ‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶®‡ßá‡¶∞ ‡¶∏‡¶Ç‡¶ñ‡ßç‡¶Ø‡¶æ:</label
                >
                <div class="relative">
                  <input
                    type="number"
                    id="mcq-number"
                    name="mcq-number"
                    required
                    placeholder="‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶®‡ßá‡¶∞ ‡¶∏‡¶Ç‡¶ñ‡ßç‡¶Ø‡¶æ ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶®"
                    min="1"
                    max="100"
                    class="w-full px-3 py-2 sm:px-4 sm:py-3 border-2 border-white/30 rounded-xl bg-white/80 glass-morphism text-sm sm:text-base transition-all duration-300 focus:outline-none focus:border-blue-600 focus:shadow-lg focus:shadow-blue-600/30 focus:-translate-y-0.5 font-hind"
                    aria-describedby="mcq-number-help"
                  />
                  <div id="mcq-number-help" class="sr-only">
                    Enter the number of MCQ questions (1-100)
                  </div>
                </div>
              </div>
              <div class="mb-4 sm:mb-6">
                <label
                  for="time-limit"
                  class="block mb-2 font-medium text-gray-700 text-sm sm:text-base font-hind"
                  ><i
                    class="fas fa-clock text-blue-600 mr-2 w-4"
                    aria-hidden="true"
                  ></i>
                  ‡¶∏‡¶Æ‡¶Ø‡¶º‡¶∏‡ßÄ‡¶Æ‡¶æ (‡¶Æ‡¶ø‡¶®‡¶ø‡¶ü‡ßá):</label
                >
                <div class="relative">
                  <input
                    type="number"
                    id="time-limit"
                    name="time-limit"
                    required
                    placeholder="‡¶∏‡¶Æ‡¶Ø‡¶º‡¶∏‡ßÄ‡¶Æ‡¶æ ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶®"
                    min="1"
                    max="300"
                    class="w-full px-3 py-2 sm:px-4 sm:py-3 border-2 border-white/30 rounded-xl bg-white/80 glass-morphism text-sm sm:text-base transition-all duration-300 focus:outline-none focus:border-blue-600 focus:shadow-lg focus:shadow-blue-600/30 focus:-translate-y-0.5 font-hind"
                    aria-describedby="time-limit-help"
                  />
                  <div id="time-limit-help" class="sr-only">
                    Enter the time limit in minutes (1-300)
                  </div>
                </div>
              </div>
              <div class="mb-4 sm:mb-6">
                <label
                  for="marks-per-question"
                  class="block mb-2 font-medium text-gray-700 text-sm sm:text-base font-hind"
                  ><i
                    class="fas fa-star text-blue-600 mr-2 w-4"
                    aria-hidden="true"
                  ></i>
                  ‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶® ‡¶™‡ßç‡¶∞‡¶§‡¶ø ‡¶®‡¶æ‡¶Æ‡ßç‡¶¨‡¶æ‡¶∞:</label
                >
                <div class="relative">
                  <input
                    type="number"
                    id="marks-per-question"
                    name="marks-per-question"
                    required
                    placeholder="‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶® ‡¶™‡ßç‡¶∞‡¶§‡¶ø ‡¶®‡¶æ‡¶Æ‡ßç‡¶¨‡¶æ‡¶∞ ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶®"
                    min="0"
                    step="0.5"
                    value="1"
                    class="w-full px-3 py-2 sm:px-4 sm:py-3 border-2 border-white/30 rounded-xl bg-white/80 glass-morphism text-sm sm:text-base transition-all duration-300 focus:outline-none focus:border-blue-600 focus:shadow-lg focus:shadow-blue-600/30 focus:-translate-y-0.5 font-hind"
                    aria-describedby="marks-per-question-help"
                  />
                  <div id="marks-per-question-help" class="sr-only">
                    Enter marks per question (minimum 0)
                  </div>
                </div>
              </div>
              <div class="mb-4 sm:mb-6">
                <label
                  for="negative-marking-value"
                  class="block mb-2 font-medium text-gray-700 text-sm sm:text-base font-hind"
                  ><i
                    class="fas fa-minus-circle text-blue-600 mr-2 w-4"
                    aria-hidden="true"
                  ></i>
                  ‡¶®‡ßá‡¶ó‡ßá‡¶ü‡¶ø‡¶≠ ‡¶Æ‡¶æ‡¶∞‡ßç‡¶ï‡¶ø‡¶Ç ‡¶Æ‡¶æ‡¶® (‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶® ‡¶™‡ßç‡¶∞‡¶§‡¶ø):</label
                >
                <div class="relative">
                  <input
                    type="number"
                    id="negative-marking-value"
                    name="negative-marking-value"
                    placeholder="‡¶®‡ßá‡¶ó‡ßá‡¶ü‡¶ø‡¶≠ ‡¶Æ‡¶æ‡¶∞‡ßç‡¶ï‡¶ø‡¶Ç ‡¶Æ‡¶æ‡¶® ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶® (0 = ‡¶¨‡¶®‡ßç‡¶ß)"
                    min="0"
                    step="0.25"
                    value="0.25"
                    class="w-full px-3 py-2 sm:px-4 sm:py-3 border-2 border-white/30 rounded-xl bg-white/80 glass-morphism text-sm sm:text-base transition-all duration-300 focus:outline-none focus:border-blue-600 focus:shadow-lg focus:shadow-blue-600/30 focus:-translate-y-0.5 font-hind"
                    aria-describedby="negative-marking-help"
                  />
                  <div id="negative-marking-help" class="sr-only">
                    Enter negative marking value per question (0 to disable)
                  </div>
                </div>
              </div>
              <button
                type="submit"
                class="block w-full py-2.5 sm:py-3.5 px-4 text-sm sm:text-base font-bold border-none rounded-xl bg-gradient-primary text-white cursor-pointer text-center transition-all duration-300 shadow-lg shadow-blue-600/30 hover:shadow-xl hover:shadow-blue-600/40 hover:-translate-y-1 active:translate-y-0 active:shadow-lg active:shadow-blue-600/30 mt-4 touch-manipulation font-hind"
                aria-label="Start the exam"
              >
                <i class="fas fa-play mr-2" aria-hidden="true"></i> ‡¶™‡¶∞‡ßÄ‡¶ï‡ßç‡¶∑‡¶æ ‡¶∂‡ßÅ‡¶∞‡ßÅ
                ‡¶ï‡¶∞‡ßÅ‡¶®
              </button>
            </form>
            <div class="text-center mt-4">
              <button
                id="view-history"
                class="inline-flex items-center px-4 sm:px-6 py-2 sm:py-3 bg-blue-500 text-white font-bold rounded-xl shadow-lg hover:shadow-xl transition-all duration-300 hover:-translate-y-1 font-hind text-sm sm:text-lg mr-2 mb-2"
                aria-label="View exam history"
              >
                <i class="fas fa-history mr-2" aria-hidden="true"></i> ‡¶á‡¶§‡¶ø‡¶π‡¶æ‡¶∏
                ‡¶¶‡ßá‡¶ñ‡ßÅ‡¶®
              </button>
              <button
                id="export-data"
                class="inline-flex items-center px-4 sm:px-6 py-2 sm:py-3 bg-green-500 text-white font-bold rounded-xl shadow-lg hover:shadow-xl transition-all duration-300 hover:-translate-y-1 font-hind text-sm sm:text-lg mr-2 mb-2"
                aria-label="Export exam data"
                title="‡¶∏‡¶Æ‡¶∏‡ßç‡¶§ ‡¶™‡¶∞‡ßÄ‡¶ï‡ßç‡¶∑‡¶æ‡¶∞ ‡¶°‡ßá‡¶ü‡¶æ ‡¶∞‡¶™‡ßç‡¶§‡¶æ‡¶®‡¶ø ‡¶ï‡¶∞‡ßÅ‡¶®"
              >
                <i class="fas fa-download mr-2" aria-hidden="true"></i> ‡¶∞‡¶™‡ßç‡¶§‡¶æ‡¶®‡¶ø
              </button>
              <button
                id="import-data"
                class="inline-flex items-center px-4 sm:px-6 py-2 sm:py-3 bg-purple-500 text-white font-bold rounded-xl shadow-lg hover:shadow-xl transition-all duration-300 hover:-translate-y-1 font-hind text-sm sm:text-lg mb-2"
                aria-label="Import exam data"
                title="‡¶™‡ßÇ‡¶∞‡ßç‡¶¨‡¶¨‡¶∞‡ßç‡¶§‡ßÄ ‡¶°‡ßá‡¶ü‡¶æ ‡¶Ü‡¶Æ‡¶¶‡¶æ‡¶®‡¶ø ‡¶ï‡¶∞‡ßÅ‡¶®"
              >
                <i class="fas fa-upload mr-2" aria-hidden="true"></i> ‡¶Ü‡¶Æ‡¶¶‡¶æ‡¶®‡¶ø
              </button>
            </div>
          </div>
        </section>

        <section
          id="test-section"
          class="min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-50 hidden"
          role="main"
          aria-labelledby="test-heading"
        >
          <div
            class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-4 sm:py-6 lg:py-8"
          >
            <!-- Test Header -->
            <div
              class="bg-white rounded-2xl shadow-xl border border-gray-200 p-4 sm:p-6 mb-6 sm:mb-8"
            >
              <div
                class="flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4"
              >
                <div class="flex-1">
                  <h2
                    id="test-heading"
                    class="text-2xl sm:text-3xl font-bold text-gray-800 font-hind mb-2"
                  >
                    <i class="fas fa-clipboard-check text-blue-600 mr-3"></i>
                    ‡¶™‡¶∞‡ßÄ‡¶ï‡ßç‡¶∑‡¶æ ‡¶ö‡¶≤‡¶õ‡ßá
                  </h2>
                  <p class="text-gray-600 font-hind text-sm sm:text-base">
                    <i class="fas fa-info-circle text-blue-500 mr-2"></i>
                    ‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶ü‡¶ø ‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶®‡ßá‡¶∞ ‡¶â‡¶§‡ßç‡¶§‡¶∞ ‡¶∏‡¶æ‡¶¨‡¶ß‡¶æ‡¶®‡ßá ‡¶™‡¶°‡¶º‡ßÅ‡¶® ‡¶è‡¶¨‡¶Ç ‡¶∏‡¶†‡¶ø‡¶ï ‡¶Ö‡¶™‡¶∂‡¶® ‡¶∏‡¶ø‡¶≤‡ßá‡¶ï‡ßç‡¶ü
                    ‡¶ï‡¶∞‡ßÅ‡¶®
                  </p>
                </div>
                <div class="flex items-center gap-4">
                  <div
                    class="bg-blue-50 border border-blue-200 rounded-xl px-4 py-3"
                  >
                    <div
                      class="text-xs text-blue-600 font-semibold font-hind mb-1"
                    >
                      ‡¶Ö‡¶¨‡¶∂‡¶ø‡¶∑‡ßç‡¶ü ‡¶∏‡¶Æ‡¶Ø‡¶º
                    </div>
                    <div
                      class="text-lg sm:text-xl font-bold text-blue-700 font-mono"
                      id="timer-compact"
                    ></div>
                  </div>
                  <div
                    class="bg-green-50 border border-green-200 rounded-xl px-4 py-3"
                  >
                    <div
                      class="text-xs text-green-600 font-semibold font-hind mb-1"
                    >
                      ‡¶â‡¶§‡ßç‡¶§‡¶∞ ‡¶¶‡ßá‡¶ì‡¶Ø‡¶º‡¶æ
                    </div>
                    <div
                      class="text-lg sm:text-xl font-bold text-green-700"
                      id="answered-count"
                    >
                      0
                    </div>
                  </div>
                  <div
                    class="bg-yellow-50 border border-yellow-200 rounded-xl px-3 py-2 flex items-center gap-2"
                    id="auto-save-indicator"
                    style="display: none"
                  >
                    <i
                      class="fas fa-save text-yellow-600 text-sm animate-pulse"
                    ></i>
                    <span
                      class="text-xs text-yellow-700 font-semibold font-hind"
                      >‡¶∏‡ßá‡¶≠ ‡¶π‡¶ö‡ßç‡¶õ‡ßá...</span
                    >
                  </div>
                </div>
              </div>
            </div>

            <!-- Test Details -->
            <div
              class="bg-white rounded-2xl shadow-lg border border-gray-200 p-4 sm:p-6 mb-6 sm:mb-8"
              id="test-details"
            ></div>

            <!-- Questions Container -->
            <div
              class="space-y-4 sm:space-y-6"
              id="mcq-container"
              role="radiogroup"
              aria-label="Multiple choice questions"
            ></div>

            <!-- Submit Section -->
            <div
              class="mt-8 sm:mt-12 bg-white rounded-2xl shadow-xl border border-gray-200 p-4 sm:p-6"
            >
              <div class="text-center">
                <div
                  class="bg-amber-50 border border-amber-200 rounded-xl p-4 mb-6"
                >
                  <div
                    class="flex items-center justify-center gap-3 text-amber-800"
                  >
                    <i class="fas fa-exclamation-triangle text-xl"></i>
                    <div>
                      <div class="font-semibold font-hind">
                        ‡¶∏‡¶æ‡¶¨‡¶Æ‡¶ø‡¶ü ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶Ü‡¶ó‡ßá ‡¶®‡¶ø‡¶∂‡ßç‡¶ö‡¶ø‡¶§ ‡¶π‡ßã‡¶®
                      </div>
                      <div class="text-sm font-hind mt-1">
                        ‡¶è‡¶ï‡¶¨‡¶æ‡¶∞ ‡¶∏‡¶æ‡¶¨‡¶Æ‡¶ø‡¶ü ‡¶ï‡¶∞‡¶≤‡ßá ‡¶™‡¶∞‡¶ø‡¶¨‡¶∞‡ßç‡¶§‡¶® ‡¶ï‡¶∞‡¶æ ‡¶Ø‡¶æ‡¶¨‡ßá ‡¶®‡¶æ
                      </div>
                    </div>
                  </div>
                </div>
                <button
                  id="submit-test"
                  class="inline-flex items-center px-8 sm:px-12 py-4 sm:py-5 bg-gradient-to-r from-green-500 to-green-600 text-white font-bold rounded-xl shadow-xl shadow-green-600/30 transition-all duration-300 hover:shadow-2xl hover:shadow-green-600/40 hover:-translate-y-1 text-lg sm:text-xl font-hind"
                  aria-label="Submit the test"
                >
                  <i class="fas fa-paper-plane mr-3"></i>
                  ‡¶™‡¶∞‡ßÄ‡¶ï‡ßç‡¶∑‡¶æ ‡¶ú‡¶Æ‡¶æ ‡¶¶‡¶ø‡¶®
                </button>
              </div>
            </div>
          </div>

          <!-- Floating Summary Button -->
          <div
            id="floating-summary"
            class="fixed bottom-6 right-6 sm:bottom-8 sm:right-8 w-14 h-14 sm:w-16 sm:h-16 bg-gradient-primary border-4 border-white rounded-full shadow-2xl flex items-center justify-center cursor-pointer transition-all duration-300 hover:scale-110 z-50 touch-manipulation touch-target touch-optimize mobile-floating-bottom"
            role="button"
            aria-label="Toggle question summary"
            tabindex="0"
          >
            <i
              class="fas fa-list-check text-white text-lg sm:text-xl icon-sharp"
            ></i>
            <!-- Progress indicator for mobile -->
            <div
              class="absolute -top-2 -right-2 w-6 h-6 bg-red-500 text-white text-xs rounded-full flex items-center justify-center font-bold"
            >
              <span id="floating-answered-count">0</span>
            </div>
          </div>

          <section
            id="correct-answer-section"
            class="bg-white/95 backdrop-blur-sm rounded-xl sm:rounded-2xl shadow-xl border border-white/30 mb-6 sm:mb-8 lg:mb-12 hidden"
            role="main"
            aria-labelledby="correct-answer-heading"
          >
            <div class="p-4 sm:p-6 lg:p-8">
              <h2
                id="correct-answer-heading"
                class="text-gray-800 font-semibold mb-4 sm:mb-6 font-hind text-lg sm:text-xl"
              >
                <i
                  class="fas fa-check-circle text-blue-600 mr-2"
                  aria-hidden="true"
                ></i>
                ‡¶∏‡¶†‡¶ø‡¶ï ‡¶â‡¶§‡ßç‡¶§‡¶∞ ‡¶®‡¶ø‡¶∞‡ßç‡¶¨‡¶æ‡¶ö‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®
              </h2>
              <div
                id="correct-answer-container"
                role="radiogroup"
                aria-label="Correct answer selection"
              ></div>
              <p
                id="warning-message"
                class="bg-red-50 border-2 border-red-300 rounded-xl p-3 sm:p-4 my-4 text-red-700 font-semibold text-center font-hind text-sm sm:text-base hidden"
                role="alert"
                aria-live="polite"
              >
                ‡¶∏‡¶¨‡¶ó‡ßÅ‡¶≤‡ßã ‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶®‡ßá‡¶∞ ‡¶∏‡¶†‡¶ø‡¶ï ‡¶â‡¶§‡ßç‡¶§‡¶∞ ‡¶∏‡¶ø‡¶≤‡ßá‡¶ï‡ßç‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®‡•§ ‡¶Ö‡¶®‡ßç‡¶Ø‡¶•‡¶æ‡¶Ø‡¶º ‡¶∏‡¶æ‡¶¨‡¶Æ‡¶ø‡¶ü ‡¶ï‡¶∞‡¶§‡ßá
                ‡¶™‡¶æ‡¶∞‡¶¨‡ßá‡¶® ‡¶®‡¶æ‡•§
              </p>

              <button
                id="submit-correct-answers"
                class="bg-gradient-accent text-white px-6 sm:px-8 py-3 sm:py-4 rounded-xl font-bold shadow-xl shadow-pink-600/30 transition-all duration-300 hover:shadow-2xl hover:shadow-pink-600/40 hover:-translate-y-1 font-hind text-base sm:text-lg"
                disabled
                aria-label="Submit correct answers"
              >
                <i class="fas fa-check-double mr-2" aria-hidden="true"></i> ‡¶∏‡¶†‡¶ø‡¶ï
                ‡¶â‡¶§‡ßç‡¶§‡¶∞ ‡¶ú‡¶Æ‡¶æ ‡¶¶‡¶ø‡¶®
              </button>
            </div>
          </section>

          <section
            id="result-section"
            class="bg-white/95 backdrop-blur-sm rounded-xl sm:rounded-2xl shadow-xl border border-white/30 mb-6 sm:mb-8 lg:mb-12 hidden"
            role="main"
            aria-labelledby="result-heading"
          >
            <div class="p-4 sm:p-6 lg:p-8">
              <h2
                id="result-heading"
                class="text-gray-800 font-semibold mb-4 sm:mb-6 font-hind text-lg sm:text-xl md:text-2xl"
              >
                <i
                  class="fas fa-chart-bar text-blue-600 mr-2"
                  aria-hidden="true"
                ></i>
                ‡¶™‡¶∞‡ßÄ‡¶ï‡ßç‡¶∑‡¶æ‡¶∞ ‡¶´‡¶≤‡¶æ‡¶´‡¶≤
              </h2>
              <div
                id="result-container"
                role="region"
                aria-label="Exam results"
              ></div>
              <div
                class="mt-6 sm:mt-8 space-y-3 sm:space-y-0 sm:flex sm:flex-wrap sm:justify-center sm:gap-4 no-print"
              >
                <button
                  id="save-test"
                  class="w-full sm:w-auto sm:flex-1 sm:max-w-xs inline-flex items-center justify-center px-4 sm:px-6 py-3 sm:py-3 bg-green-500 text-white font-bold rounded-xl shadow-lg hover:shadow-xl transition-all duration-300 hover:-translate-y-1 font-hind text-sm sm:text-base"
                  aria-label="Save test results"
                >
                  <i class="fas fa-save mr-2" aria-hidden="true"></i> ‡¶™‡¶∞‡ßÄ‡¶ï‡ßç‡¶∑‡¶æ
                  ‡¶∏‡ßá‡¶≠ ‡¶ï‡¶∞‡ßÅ‡¶®
                </button>
                <button
                  id="print-result"
                  class="w-full sm:w-auto sm:flex-1 sm:max-w-xs inline-flex items-center justify-center px-4 sm:px-6 py-3 sm:py-3 bg-gradient-primary text-white font-bold rounded-xl shadow-lg hover:shadow-xl transition-all duration-300 hover:-translate-y-1 font-hind text-sm sm:text-base"
                  aria-label="Print results"
                >
                  <i class="fas fa-print mr-2" aria-hidden="true"></i> ‡¶™‡ßç‡¶∞‡¶ø‡¶®‡ßç‡¶ü
                  ‡¶ï‡¶∞‡ßÅ‡¶®
                </button>
                <button
                  id="restart-btn"
                  class="w-full sm:w-auto sm:flex-1 sm:max-w-xs inline-flex items-center justify-center px-4 sm:px-6 py-3 sm:py-3 bg-gradient-primary text-white font-bold rounded-xl shadow-lg hover:shadow-xl transition-all duration-300 hover:-translate-y-1 font-hind text-sm sm:text-base"
                  aria-label="Start new exam"
                >
                  <i class="fas fa-redo mr-2" aria-hidden="true"></i> ‡¶®‡¶§‡ßÅ‡¶®
                  ‡¶™‡¶∞‡ßÄ‡¶ï‡ßç‡¶∑‡¶æ ‡¶∂‡ßÅ‡¶∞‡ßÅ ‡¶ï‡¶∞‡ßÅ‡¶®
                </button>
              </div>
            </div>
          </section>

          <section
            id="history-section"
            class="bg-white/95 backdrop-blur-sm rounded-xl sm:rounded-2xl shadow-xl border border-white/30 mb-6 sm:mb-8 lg:mb-12 hidden"
            role="main"
            aria-labelledby="history-heading"
          >
            <div class="p-4 sm:p-6 lg:p-8">
              <h2
                id="history-heading"
                class="text-gray-800 font-semibold mb-4 sm:mb-6 font-hind text-lg sm:text-xl"
              >
                <i
                  class="fas fa-history text-blue-600 mr-2"
                  aria-hidden="true"
                ></i>
                ‡¶™‡¶∞‡ßÄ‡¶ï‡ßç‡¶∑‡¶æ‡¶∞ ‡¶á‡¶§‡¶ø‡¶π‡¶æ‡¶∏
              </h2>
              <div class="text-center mb-4">
                <button
                  id="back-to-home"
                  class="inline-flex items-center px-4 sm:px-6 py-2 sm:py-3 bg-gray-500 text-white font-bold rounded-xl shadow-lg hover:shadow-xl transition-all duration-300 hover:-translate-y-1 font-hind text-sm sm:text-lg"
                  aria-label="Return to home"
                >
                  <i class="fas fa-home mr-2" aria-hidden="true"></i> ‡¶π‡ßã‡¶Æ‡ßá ‡¶´‡¶ø‡¶∞‡ßá
                  ‡¶Ø‡¶æ‡¶®
                </button>
              </div>
              <div
                id="history-container"
                role="region"
                aria-label="Exam history"
              ></div>
            </div>
          </section>
        </section>
      </div>
    </main>

    <!-- App Footer -->
    <footer class="bg-gray-900 text-white">
      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
        <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
          <div>
            <div class="flex items-center space-x-2 mb-4">
              <div class="bg-gradient-primary p-2 rounded-lg">
                <i class="fas fa-graduation-cap text-white"></i>
              </div>
              <span class="text-lg font-bold font-hind"
                >‡¶™‡¶∞‡ßÄ‡¶ï‡ßç‡¶∑‡¶æ ‡¶®‡¶ø‡¶Ø‡¶º‡¶®‡ßç‡¶§‡ßç‡¶∞‡¶ï</span
              >
            </div>
            <p class="text-gray-400 text-sm font-hind">
              ‡¶è‡¶ï‡¶ü‡¶ø ‡¶∏‡¶π‡¶ú ‡¶è‡¶¨‡¶Ç ‡¶ï‡¶æ‡¶∞‡ßç‡¶Ø‡¶ï‡¶∞‡ßÄ ‡¶™‡¶∞‡ßÄ‡¶ï‡ßç‡¶∑‡¶æ ‡¶™‡¶∞‡¶ø‡¶ö‡¶æ‡¶≤‡¶®‡¶æ ‡¶∏‡¶ø‡¶∏‡ßç‡¶ü‡ßá‡¶Æ ‡¶Ø‡¶æ ‡¶∂‡¶ø‡¶ï‡ßç‡¶∑‡¶ï ‡¶è‡¶¨‡¶Ç
              ‡¶∂‡¶ø‡¶ï‡ßç‡¶∑‡¶æ‡¶∞‡ßç‡¶•‡ßÄ‡¶¶‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶°‡¶ø‡¶ú‡¶æ‡¶á‡¶® ‡¶ï‡¶∞‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá‡•§
            </p>
          </div>
          <div>
            <h3 class="text-lg font-semibold mb-4 font-hind">‡¶¨‡ßà‡¶∂‡¶ø‡¶∑‡ßç‡¶ü‡ßç‡¶Ø‡¶∏‡¶Æ‡ßÇ‡¶π</h3>
            <ul class="space-y-2 text-gray-400 text-sm font-hind">
              <li>
                <i class="fas fa-check text-green-400 mr-2"></i>‡¶∏‡ßç‡¶¨‡¶Ø‡¶º‡¶Ç‡¶ï‡ßç‡¶∞‡¶ø‡¶Ø‡¶º
                ‡¶ü‡¶æ‡¶á‡¶Æ‡¶æ‡¶∞
              </li>
              <li>
                <i class="fas fa-check text-green-400 mr-2"></i>‡¶®‡ßá‡¶ó‡ßá‡¶ü‡¶ø‡¶≠ ‡¶Æ‡¶æ‡¶∞‡ßç‡¶ï‡¶ø‡¶Ç
              </li>
              <li>
                <i class="fas fa-check text-green-400 mr-2"></i>‡¶´‡¶≤‡¶æ‡¶´‡¶≤ ‡¶¨‡¶ø‡¶∂‡ßç‡¶≤‡ßá‡¶∑‡¶£
              </li>
              <li>
                <i class="fas fa-check text-green-400 mr-2"></i>‡¶™‡¶∞‡ßÄ‡¶ï‡ßç‡¶∑‡¶æ ‡¶á‡¶§‡¶ø‡¶π‡¶æ‡¶∏
              </li>
            </ul>
          </div>
          <div>
            <h3 class="text-lg font-semibold mb-4 font-hind">‡¶Ø‡ßã‡¶ó‡¶æ‡¶Ø‡ßã‡¶ó</h3>
            <div class="space-y-2 text-gray-400 text-sm">
              <p class="flex items-center font-hind">
                <i class="fas fa-envelope mr-2"></i>
                support@beexaminer.com
              </p>
              <p class="flex items-center font-hind">
                <i class="fas fa-globe mr-2"></i>
                www.beexaminer.com
              </p>
              <p class="flex items-center font-hind">
                <i class="fas fa-code mr-2"></i>
                Open Source Project
              </p>
            </div>
          </div>
        </div>
        <div class="border-t border-gray-800 mt-8 pt-8 text-center">
          <p class="text-gray-400 text-sm font-hind">
            &copy; 2025 ‡¶™‡¶∞‡ßÄ‡¶ï‡ßç‡¶∑‡¶æ ‡¶®‡¶ø‡¶Ø‡¶º‡¶®‡ßç‡¶§‡ßç‡¶∞‡¶ï - Be Examiner. All rights reserved.
          </p>
        </div>
      </div>
    </footer>
    <script>
      // --- utils (inlined) ---
      function updateDateTime() {
        const now = new Date();
        const timeElement = document.getElementById("current-time");
        const dateElement = document.getElementById("current-date");
        if (timeElement) {
          timeElement.textContent = now.toLocaleTimeString("bn-BD", {
            hour: "2-digit",
            minute: "2-digit",
            second: "2-digit",
          });
        }
        if (dateElement) {
          dateElement.textContent = now.toLocaleDateString("bn-BD", {
            year: "numeric",
            month: "long",
            day: "numeric",
          });
        }
      }
      function initDateTimeUpdate() {
        updateDateTime();
        setInterval(updateDateTime, 1000);
      }

      class ExamApp {
        constructor() {
          // Performance monitoring
          this.performanceStart = performance.now();
          this.isLoading = false;
          this.domCache = new Map();

          this.testData = {
            name: "",
            mcqNumber: 0,
            timeLimit: 0,
            marksPerQuestion: 1,
            negativeMarkingValue: 0.25,
          };
          this.timer = null;
          this.retakeData = null;
          this.summaryVisible = false;
          this.eventListeners = new Map();
          this.flaggedQuestions = new Set();

          // Initialize performance tracking
          this.trackPerformance();

          // Load saved flagged questions
          const savedFlags = this.safeLocalStorageGet("flaggedQuestions", []);
          this.flaggedQuestions = new Set(savedFlags);

          this.init();
        }

        // Enhanced DOM element caching system
        cacheElement(key, id) {
          const element = document.getElementById(id);
          if (element) {
            this.domCache.set(key, element);
            return element;
          }
          return null;
        }

        getCachedElement(key) {
          return (
            this.domCache.get(key) ||
            document.getElementById(key.replace("cache-", ""))
          );
        }

        refreshCache() {
          // Refresh cached elements that may have been recreated
          this.cacheElement("timer", "timer");
          this.cacheElement("timer-compact", "timer-compact");
          this.cacheElement("floating-summary", "floating-summary");
          this.cacheElement("answered-count", "answered-count");
        }

        // Performance tracking
        trackPerformance() {
          try {
            // Track key performance metrics
            this.performanceMetrics = {
              domReady: 0,
              testsLoaded: 0,
              firstInteraction: 0,
              memoryUsage: 0,
            };

            // Monitor memory usage periodically (only if supported)
            if ("memory" in performance) {
              this.memoryMonitor = setInterval(() => {
                this.performanceMetrics.memoryUsage =
                  performance.memory.usedJSHeapSize / 1024 / 1024; // MB

                // Warn if memory usage is high
                if (this.performanceMetrics.memoryUsage > 50) {
                  console.warn(
                    "High memory usage detected:",
                    Math.round(this.performanceMetrics.memoryUsage) + "MB",
                  );
                }
              }, 60000); // Check every minute
            }

            // Track DOM ready time
            if (document.readyState === "complete") {
              this.performanceMetrics.domReady =
                performance.now() - this.performanceStart;
            } else {
              document.addEventListener("DOMContentLoaded", () => {
                this.performanceMetrics.domReady =
                  performance.now() - this.performanceStart;
              });
            }
          } catch (error) {
            console.warn("Performance tracking not available:", error);
          }
        }

        // Optimized loading state management
        setLoadingState(isLoading, message = "") {
          this.isLoading = isLoading;

          try {
            let loadingOverlay = document.getElementById("loading-overlay");

            if (isLoading) {
              if (!loadingOverlay) {
                loadingOverlay = document.createElement("div");
                loadingOverlay.id = "loading-overlay";
                loadingOverlay.className =
                  "fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[100] touch-optimize";
                loadingOverlay.innerHTML = `
                  <div class="bg-white rounded-lg p-6 max-w-sm w-full mx-4 text-center shadow-2xl">
                    <div class="animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"></div>
                    <div id="loading-message" class="text-gray-700 font-hind text-sm sm:text-base">${message || "‡¶≤‡ßã‡¶° ‡¶π‡¶ö‡ßç‡¶õ‡ßá..."}</div>
                    <div id="loading-progress" class="w-full bg-gray-200 rounded-full h-2 mt-3">
                      <div id="loading-bar" class="bg-blue-600 h-2 rounded-full transition-all duration-300" style="width: 0%"></div>
                    </div>
                  </div>
                `;
                document.body.appendChild(loadingOverlay);
              } else {
                loadingOverlay.style.display = "flex";
                const messageEl =
                  loadingOverlay.querySelector("#loading-message");
                if (messageEl && message) {
                  messageEl.textContent = message;
                }
              }
            } else {
              if (loadingOverlay) {
                loadingOverlay.style.display = "none";
              }
            }
          } catch (error) {
            console.error("Error managing loading state:", error);
          }
        }

        updateLoadingProgress(percentage) {
          try {
            const progressBar = document.getElementById("loading-bar");
            if (progressBar) {
              progressBar.style.width = `${Math.max(0, Math.min(100, percentage))}%`;
            }
          } catch (error) {
            console.error("Error updating loading progress:", error);
          }
        }

        // Cleanup method for memory management
        cleanup() {
          try {
            // Clear timer
            if (this.timerInterval) {
              clearInterval(this.timerInterval);
              this.timerInterval = null;
            }

            // Clear memory monitor
            if (this.memoryMonitor) {
              clearInterval(this.memoryMonitor);
              this.memoryMonitor = null;
            }

            // Clear all event listeners
            this.eventListeners.forEach((handler, key) => {
              const [elementId, event] = key.split("-");
              const element = document.getElementById(elementId);
              if (element && handler) {
                element.removeEventListener(event, handler);
              }
            });
            this.eventListeners.clear();

            // Clear DOM cache
            this.domCache.clear();

            console.log("ExamApp cleaned up successfully");
          } catch (error) {
            console.error("Error during cleanup:", error);
          }
        }

        init() {
          this.setupEventListeners();
          this.showSection("configuration-section");
          initDateTimeUpdate();
        }

        // Data Export/Import Functionality
        exportData() {
          try {
            this.setLoadingState(true, "‡¶°‡ßá‡¶ü‡¶æ ‡¶∞‡¶™‡ßç‡¶§‡¶æ‡¶®‡¶ø ‡¶ï‡¶∞‡¶æ ‡¶π‡¶ö‡ßç‡¶õ‡ßá...");

            // Collect all data to export
            const exportData = {
              metadata: {
                exportDate: new Date().toISOString(),
                appVersion: "1.0.0",
                exportType: "full",
                totalTests: 0,
              },
              examHistory: this.safeLocalStorageGet("examHistory", []),
              flaggedQuestions: Array.from(this.flaggedQuestions),
              userPreferences: {
                flaggedQuestions: this.safeLocalStorageGet(
                  "flaggedQuestions",
                  [],
                ),
              },
            };

            exportData.metadata.totalTests = exportData.examHistory.length;

            // Create downloadable JSON file
            const dataStr = JSON.stringify(exportData, null, 2);
            const dataBlob = new Blob([dataStr], { type: "application/json" });

            // Create download link
            const downloadUrl = URL.createObjectURL(dataBlob);
            const downloadLink = document.createElement("a");
            downloadLink.href = downloadUrl;
            downloadLink.download = `exam-data-backup-${new Date().toISOString().split("T")[0]}.json`;

            // Trigger download
            document.body.appendChild(downloadLink);
            downloadLink.click();
            document.body.removeChild(downloadLink);

            // Clean up URL
            URL.revokeObjectURL(downloadUrl);

            this.setLoadingState(false);
            this.showUserMessage(
              `${exportData.metadata.totalTests}‡¶ü‡¶ø ‡¶™‡¶∞‡ßÄ‡¶ï‡ßç‡¶∑‡¶æ‡¶∞ ‡¶°‡ßá‡¶ü‡¶æ ‡¶∞‡¶™‡ßç‡¶§‡¶æ‡¶®‡¶ø ‡¶∏‡¶´‡¶≤ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá‡•§`,
              "success",
            );

            // Track export for analytics
            if (this.performanceMetrics) {
              this.performanceMetrics.exportsCompleted =
                (this.performanceMetrics.exportsCompleted || 0) + 1;
            }
          } catch (error) {
            console.error("Export error:", error);
            this.setLoadingState(false);
            this.showUserMessage("‡¶°‡ßá‡¶ü‡¶æ ‡¶∞‡¶™‡ßç‡¶§‡¶æ‡¶®‡¶ø‡¶§‡ßá ‡¶∏‡¶Æ‡¶∏‡ßç‡¶Ø‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá‡•§", "error");
          }
        }

        importData() {
          try {
            // Create file input element
            const fileInput = document.createElement("input");
            fileInput.type = "file";
            fileInput.accept = ".json,application/json";
            fileInput.style.display = "none";

            fileInput.addEventListener("change", (e) => {
              const file = e.target.files[0];
              if (!file) return;

              this.setLoadingState(true, "‡¶°‡ßá‡¶ü‡¶æ ‡¶Ü‡¶Æ‡¶¶‡¶æ‡¶®‡¶ø ‡¶ï‡¶∞‡¶æ ‡¶π‡¶ö‡ßç‡¶õ‡ßá...");

              const reader = new FileReader();
              reader.onload = (event) => {
                try {
                  const importedData = JSON.parse(event.target.result);
                  this.processImportedData(importedData);
                } catch (parseError) {
                  console.error("Import parse error:", parseError);
                  this.setLoadingState(false);
                  this.showUserMessage(
                    "‡¶´‡¶æ‡¶á‡¶≤ ‡¶™‡¶°‡¶º‡¶§‡ßá ‡¶∏‡¶Æ‡¶∏‡ßç‡¶Ø‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá‡•§ ‡¶∏‡¶†‡¶ø‡¶ï JSON ‡¶´‡¶æ‡¶á‡¶≤ ‡¶®‡¶ø‡¶∞‡ßç‡¶¨‡¶æ‡¶ö‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®‡•§",
                    "error",
                  );
                }
              };

              reader.onerror = () => {
                this.setLoadingState(false);
                this.showUserMessage("‡¶´‡¶æ‡¶á‡¶≤ ‡¶™‡¶°‡¶º‡¶§‡ßá ‡¶∏‡¶Æ‡¶∏‡ßç‡¶Ø‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá‡•§", "error");
              };

              reader.readAsText(file);
            });

            document.body.appendChild(fileInput);
            fileInput.click();
            document.body.removeChild(fileInput);
          } catch (error) {
            console.error("Import setup error:", error);
            this.showUserMessage(
              "‡¶°‡ßá‡¶ü‡¶æ ‡¶Ü‡¶Æ‡¶¶‡¶æ‡¶®‡¶ø ‡¶∂‡ßÅ‡¶∞‡ßÅ ‡¶ï‡¶∞‡¶§‡ßá ‡¶∏‡¶Æ‡¶∏‡ßç‡¶Ø‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá‡•§",
              "error",
            );
          }
        }

        processImportedData(importedData) {
          try {
            // Validate imported data structure
            if (!this.validateImportData(importedData)) {
              this.setLoadingState(false);
              this.showUserMessage(
                "‡¶Ü‡¶Æ‡¶¶‡¶æ‡¶®‡¶ø‡¶ï‡ßÉ‡¶§ ‡¶°‡ßá‡¶ü‡¶æ‡¶∞ ‡¶´‡¶∞‡¶Æ‡ßç‡¶Ø‡¶æ‡¶ü ‡¶∏‡¶†‡¶ø‡¶ï ‡¶®‡¶Ø‡¶º‡•§",
                "error",
              );
              return;
            }

            // Ask user for import preferences
            this.showImportOptions(importedData);
          } catch (error) {
            console.error("Import processing error:", error);
            this.setLoadingState(false);
            this.showUserMessage("‡¶°‡ßá‡¶ü‡¶æ ‡¶™‡ßç‡¶∞‡¶ï‡ßç‡¶∞‡¶ø‡¶Ø‡¶º‡¶æ‡¶ï‡¶∞‡¶£‡ßá ‡¶∏‡¶Æ‡¶∏‡ßç‡¶Ø‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá‡•§", "error");
          }
        }

        validateImportData(data) {
          try {
            // Check required structure
            return (
              data &&
              data.metadata &&
              Array.isArray(data.examHistory) &&
              data.metadata.exportDate &&
              data.metadata.appVersion
            );
          } catch (error) {
            console.error("Validation error:", error);
            return false;
          }
        }

        showImportOptions(importedData) {
          const modal = document.createElement("div");
          modal.className =
            "fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[110] p-4";
          modal.innerHTML = `
            <div class="bg-white rounded-lg max-w-md w-full p-6 font-hind">
              <h3 class="text-xl font-bold mb-4 text-gray-800">
                <i class="fas fa-download text-blue-600 mr-2"></i>‡¶°‡ßá‡¶ü‡¶æ ‡¶Ü‡¶Æ‡¶¶‡¶æ‡¶®‡¶ø
              </h3>
              <div class="mb-4">
                <p class="text-sm text-gray-600 mb-3">
                  ‡¶Ü‡¶Æ‡¶¶‡¶æ‡¶®‡¶ø‡¶ï‡ßÉ‡¶§ ‡¶°‡ßá‡¶ü‡¶æ: <strong>${importedData.examHistory.length}‡¶ü‡¶ø ‡¶™‡¶∞‡ßÄ‡¶ï‡ßç‡¶∑‡¶æ</strong><br>
                  ‡¶∞‡¶™‡ßç‡¶§‡¶æ‡¶®‡¶ø‡¶∞ ‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ: <strong>${new Date(importedData.metadata.exportDate).toLocaleDateString("bn-BD")}</strong>
                </p>
                <div class="space-y-2">
                  <label class="flex items-center">
                    <input type="radio" name="importMode" value="merge" checked class="mr-2">
                    <span class="text-sm">‡¶¨‡¶ø‡¶¶‡ßç‡¶Ø‡¶Æ‡¶æ‡¶® ‡¶°‡ßá‡¶ü‡¶æ‡¶∞ ‡¶∏‡¶æ‡¶•‡ßá ‡¶Ø‡ßÅ‡¶ï‡ßç‡¶§ ‡¶ï‡¶∞‡ßÅ‡¶®</span>
                  </label>
                  <label class="flex items-center">
                    <input type="radio" name="importMode" value="replace" class="mr-2">
                    <span class="text-sm">‡¶¨‡¶ø‡¶¶‡ßç‡¶Ø‡¶Æ‡¶æ‡¶® ‡¶°‡ßá‡¶ü‡¶æ ‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶∏‡ßç‡¶•‡¶æ‡¶™‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®</span>
                  </label>
                </div>
              </div>
              <div class="flex gap-3 justify-end">
                <button id="cancelImport" class="px-4 py-2 bg-gray-500 text-white rounded hover:bg-gray-600 transition-colors">
                  ‡¶¨‡¶æ‡¶§‡¶ø‡¶≤
                </button>
                <button id="confirmImport" class="px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600 transition-colors">
                  ‡¶Ü‡¶Æ‡¶¶‡¶æ‡¶®‡¶ø ‡¶ï‡¶∞‡ßÅ‡¶®
                </button>
              </div>
            </div>
          `;

          document.body.appendChild(modal);

          // Handle cancel
          modal.querySelector("#cancelImport").addEventListener("click", () => {
            document.body.removeChild(modal);
            this.setLoadingState(false);
          });

          // Handle confirm
          modal
            .querySelector("#confirmImport")
            .addEventListener("click", () => {
              const importMode = modal.querySelector(
                'input[name="importMode"]:checked',
              ).value;
              document.body.removeChild(modal);
              this.executeImport(importedData, importMode);
            });

          // Close on background click
          modal.addEventListener("click", (e) => {
            if (e.target === modal) {
              document.body.removeChild(modal);
              this.setLoadingState(false);
            }
          });
        }

        executeImport(importedData, importMode) {
          try {
            let currentHistory = this.safeLocalStorageGet("examHistory", []);
            let importedHistory = importedData.examHistory || [];
            let finalHistory = [];

            if (importMode === "replace") {
              finalHistory = importedHistory;
              this.showUserMessage(
                "‡¶™‡ßÅ‡¶∞‡¶æ‡¶®‡ßã ‡¶°‡ßá‡¶ü‡¶æ ‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶∏‡ßç‡¶•‡¶æ‡¶™‡¶ø‡¶§ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá‡•§",
                "warning",
              );
            } else {
              // Merge mode - avoid duplicates by checking timestamps and names
              finalHistory = [...currentHistory];
              let newTestsCount = 0;

              importedHistory.forEach((importedTest) => {
                const isDuplicate = currentHistory.some(
                  (existingTest) =>
                    existingTest.timestamp === importedTest.timestamp &&
                    existingTest.testName === importedTest.testName,
                );

                if (!isDuplicate) {
                  finalHistory.push(importedTest);
                  newTestsCount++;
                }
              });

              this.showUserMessage(
                `${newTestsCount}‡¶ü‡¶ø ‡¶®‡¶§‡ßÅ‡¶® ‡¶™‡¶∞‡ßÄ‡¶ï‡ßç‡¶∑‡¶æ ‡¶Ø‡ßÅ‡¶ï‡ßç‡¶§ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá‡•§`,
                "success",
              );
            }

            // Save merged/replaced data
            if (!this.safeLocalStorageSet("examHistory", finalHistory)) {
              throw new Error("Failed to save exam history");
            }

            // Import flagged questions if available
            if (
              importedData.userPreferences &&
              importedData.userPreferences.flaggedQuestions
            ) {
              const currentFlags = this.safeLocalStorageGet(
                "flaggedQuestions",
                [],
              );
              const importedFlags =
                importedData.userPreferences.flaggedQuestions;

              if (importMode === "replace") {
                this.safeLocalStorageSet("flaggedQuestions", importedFlags);
                this.flaggedQuestions = new Set(importedFlags);
              } else {
                const mergedFlags = [
                  ...new Set([...currentFlags, ...importedFlags]),
                ];
                this.safeLocalStorageSet("flaggedQuestions", mergedFlags);
                this.flaggedQuestions = new Set(mergedFlags);
              }
            }

            this.setLoadingState(false);
            this.showUserMessage(
              "‡¶°‡ßá‡¶ü‡¶æ ‡¶Ü‡¶Æ‡¶¶‡¶æ‡¶®‡¶ø ‡¶∏‡¶´‡¶≤ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá! ‡¶™‡ßÉ‡¶∑‡ßç‡¶†‡¶æ ‡¶∞‡¶ø‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡ßÅ‡¶®‡•§",
              "success",
            );

            // Refresh history if currently viewing
            if (this.currentTab === "history") {
              setTimeout(() => {
                this.loadHistory();
              }, 2000);
            }
          } catch (error) {
            console.error("Import execution error:", error);
            this.setLoadingState(false);
            this.showUserMessage("‡¶°‡ßá‡¶ü‡¶æ ‡¶∏‡¶Ç‡¶∞‡¶ï‡ßç‡¶∑‡¶£‡ßá ‡¶∏‡¶Æ‡¶∏‡ßç‡¶Ø‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá‡•§", "error");
          }
        }

        // Quick export for current test only
        exportCurrentTest() {
          try {
            if (!this.testData || !this.testData.name) {
              this.showUserMessage("‡¶ï‡ßã‡¶® ‡¶™‡¶∞‡ßÄ‡¶ï‡ßç‡¶∑‡¶æ ‡¶ö‡¶≤‡¶Æ‡¶æ‡¶® ‡¶®‡ßá‡¶á‡•§", "warning");
              return;
            }

            // Collect current test progress
            const currentProgress = {
              testData: this.testData,
              answers: this.collectCurrentAnswers(),
              timeRemaining: this.timeRemaining,
              timestamp: new Date().toISOString(),
              flaggedQuestions: Array.from(this.flaggedQuestions),
            };

            // Create JSON file
            const dataStr = JSON.stringify(currentProgress, null, 2);
            const dataBlob = new Blob([dataStr], { type: "application/json" });
            const downloadUrl = URL.createObjectURL(dataBlob);
            const downloadLink = document.createElement("a");
            downloadLink.href = downloadUrl;
            downloadLink.download = `current-test-${this.testData.name}-${new Date().toISOString().split("T")[0]}.json`;

            document.body.appendChild(downloadLink);
            downloadLink.click();
            document.body.removeChild(downloadLink);
            URL.revokeObjectURL(downloadUrl);

            this.showUserMessage(
              "‡¶¨‡¶∞‡ßç‡¶§‡¶Æ‡¶æ‡¶® ‡¶™‡¶∞‡ßÄ‡¶ï‡ßç‡¶∑‡¶æ‡¶∞ ‡¶°‡ßá‡¶ü‡¶æ ‡¶∞‡¶™‡ßç‡¶§‡¶æ‡¶®‡¶ø ‡¶ï‡¶∞‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá‡•§",
              "success",
            );
          } catch (error) {
            console.error("Current test export error:", error);
            this.showUserMessage(
              "‡¶¨‡¶∞‡ßç‡¶§‡¶Æ‡¶æ‡¶® ‡¶™‡¶∞‡ßÄ‡¶ï‡ßç‡¶∑‡¶æ ‡¶∞‡¶™‡ßç‡¶§‡¶æ‡¶®‡¶ø‡¶§‡ßá ‡¶∏‡¶Æ‡¶∏‡ßç‡¶Ø‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá‡•§",
              "error",
            );
          }
        }

        collectCurrentAnswers() {
          const answers = {};
          try {
            for (let i = 1; i <= this.testData.mcqNumber; i++) {
              const selectedOption = document.querySelector(
                `input[name="q${i}"]:checked`,
              );
              if (selectedOption) {
                answers[i] = selectedOption.value;
              }
            }
          } catch (error) {
            console.error("Error collecting answers:", error);
          }
          return answers;
        }

        escapeHtml(text) {
          const map = {
            "&": "&amp;",
            "<": "&lt;",
            ">": "&gt;",
            '"': "&quot;",
            "'": "&#039;",
          };
          return text.replace(/[&<>"']/g, function (m) {
            return map[m];
          });
        }

        showSection(sectionId) {
          const sections = [
            "configuration-section",
            "test-section",
            "correct-answer-section",
            "result-section",
            "history-section",
          ];
          sections.forEach((id) => {
            const element = document.getElementById(id);
            if (element) {
              element.classList.add("hidden");
              element.setAttribute("aria-hidden", "true");
            }
          });

          const targetSection = document.getElementById(sectionId);
          if (targetSection) {
            targetSection.classList.remove("hidden");
            targetSection.removeAttribute("aria-hidden");
          }
        }
        safeLocalStorageGet(key, defaultValue = null) {
          try {
            // Check if localStorage is available
            if (typeof Storage === "undefined") {
              console.warn("localStorage is not supported by this browser");
              return defaultValue;
            }

            const item = localStorage.getItem(key);
            if (item === null) return defaultValue;

            const parsed = JSON.parse(item);
            return parsed;
          } catch (error) {
            console.error("Error reading from localStorage:", error);

            // Try to recover from corrupted data
            try {
              localStorage.removeItem(key);
            } catch (removeError) {
              console.error("Could not remove corrupted data:", removeError);
            }

            // Show user-friendly error message
            if (key === "examHistory") {
              this.showUserMessage(
                "‡¶™‡¶∞‡ßÄ‡¶ï‡ßç‡¶∑‡¶æ‡¶∞ ‡¶á‡¶§‡¶ø‡¶π‡¶æ‡¶∏ ‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡¶§‡ßá ‡¶∏‡¶Æ‡¶∏‡ßç‡¶Ø‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá‡•§ ‡¶¶‡ßÅ‡¶É‡¶ñ‡¶ø‡¶§!",
                "error",
              );
            } else if (key === "currentTestProgress") {
              this.showUserMessage(
                "‡¶∏‡¶Ç‡¶∞‡¶ï‡ßç‡¶∑‡¶ø‡¶§ ‡¶Ö‡¶ó‡ßç‡¶∞‡¶ó‡¶§‡¶ø ‡¶™‡ßÅ‡¶®‡¶∞‡ßÅ‡¶¶‡ßç‡¶ß‡¶æ‡¶∞ ‡¶ï‡¶∞‡¶æ ‡¶Ø‡¶æ‡¶Ø‡¶º‡¶®‡¶ø‡•§",
                "warning",
              );
            }

            return defaultValue;
          }
        }

        safeLocalStorageSet(key, value) {
          try {
            // Check if localStorage is available
            if (typeof Storage === "undefined") {
              console.warn("localStorage is not supported by this browser");
              this.showUserMessage(
                "‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶¨‡ßç‡¶∞‡¶æ‡¶â‡¶ú‡¶æ‡¶∞ ‡¶°‡ßá‡¶ü‡¶æ ‡¶∏‡¶Ç‡¶∞‡¶ï‡ßç‡¶∑‡¶£ ‡¶∏‡¶Æ‡¶∞‡ßç‡¶•‡¶® ‡¶ï‡¶∞‡ßá ‡¶®‡¶æ‡•§",
                "error",
              );
              return false;
            }

            // Check available storage space
            const stringified = JSON.stringify(value);
            const sizeInBytes = new Blob([stringified]).size;

            // If trying to save large data, warn user
            if (sizeInBytes > 1024 * 1024) {
              // 1MB
              this.showUserMessage(
                "‡¶°‡ßá‡¶ü‡¶æ ‡¶Ü‡¶ï‡¶æ‡¶∞ ‡¶¨‡¶°‡¶º‡•§ ‡¶∏‡¶Ç‡¶∞‡¶ï‡ßç‡¶∑‡¶£‡ßá ‡¶∏‡¶Æ‡¶Ø‡¶º ‡¶≤‡¶æ‡¶ó‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡ßá‡•§",
                "info",
              );
            }

            localStorage.setItem(key, stringified);
            return true;
          } catch (error) {
            console.error("Error writing to localStorage:", error);

            let userMessage = "‡¶°‡ßá‡¶ü‡¶æ ‡¶∏‡¶Ç‡¶∞‡¶ï‡ßç‡¶∑‡¶£ ‡¶ï‡¶∞‡¶§‡ßá ‡¶∏‡¶Æ‡¶∏‡ßç‡¶Ø‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá‡•§";

            if (error.name === "QuotaExceededError") {
              userMessage =
                "‡¶∏‡ßç‡¶ü‡ßã‡¶∞‡ßá‡¶ú ‡¶™‡ßÇ‡¶∞‡ßç‡¶£! ‡¶ï‡¶ø‡¶õ‡ßÅ ‡¶™‡ßÅ‡¶∞‡¶æ‡¶®‡ßã ‡¶°‡ßá‡¶ü‡¶æ ‡¶Æ‡ßÅ‡¶õ‡ßá ‡¶®‡¶§‡ßÅ‡¶® ‡¶ï‡¶∞‡ßá ‡¶ö‡ßá‡¶∑‡ßç‡¶ü‡¶æ ‡¶ï‡¶∞‡ßÅ‡¶®‡•§";

              // Try to clean up old data automatically
              this.cleanupOldData();
            } else if (error.name === "SecurityError") {
              userMessage = "‡¶®‡¶ø‡¶∞‡¶æ‡¶™‡¶§‡ßç‡¶§‡¶æ ‡¶∏‡ßá‡¶ü‡¶ø‡¶Ç‡¶∏‡ßá‡¶∞ ‡¶ï‡¶æ‡¶∞‡¶£‡ßá ‡¶°‡ßá‡¶ü‡¶æ ‡¶∏‡¶Ç‡¶∞‡¶ï‡ßç‡¶∑‡¶£ ‡¶ï‡¶∞‡¶æ ‡¶Ø‡¶æ‡¶Ø‡¶º‡¶®‡¶ø‡•§";
            }

            this.showUserMessage(userMessage, "error");
            return false;
          }
        }

        cleanupOldData() {
          try {
            const tests = this.safeLocalStorageGet("examHistory", []);
            if (tests.length > 50) {
              // Keep only the latest 30 tests
              const recentTests = tests.slice(-30);
              this.safeLocalStorageSet("examHistory", recentTests);
              this.showUserMessage("‡¶™‡ßÅ‡¶∞‡¶æ‡¶®‡ßã ‡¶°‡ßá‡¶ü‡¶æ ‡¶∏‡¶æ‡¶´ ‡¶ï‡¶∞‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá‡•§", "success");
            }
          } catch (error) {
            console.error("Error during cleanup:", error);
          }
        }

        showUserMessage(message, type = "info") {
          // Create or update notification system
          let notification = document.getElementById("user-notification");
          if (!notification) {
            notification = document.createElement("div");
            notification.id = "user-notification";
            notification.className =
              "fixed top-4 right-4 p-4 rounded-lg shadow-lg z-50 max-w-sm";
            notification.setAttribute("role", "alert");
            notification.setAttribute("aria-live", "polite");
            document.body.appendChild(notification);
          }

          // Set colors based on type
          const colors = {
            error: "bg-red-500 text-white border-red-600",
            warning: "bg-yellow-500 text-black border-yellow-600",
            success: "bg-green-500 text-white border-green-600",
            info: "bg-blue-500 text-white border-blue-600",
          };

          notification.className = `fixed top-4 right-4 p-4 rounded-lg shadow-lg z-50 max-w-sm border-2 ${colors[type] || colors.info}`;
          notification.innerHTML = `
            <div class="flex items-center justify-between">
              <div class="flex items-center">
                <i class="fas fa-${type === "error" ? "exclamation-triangle" : type === "success" ? "check-circle" : type === "warning" ? "exclamation-circle" : "info-circle"} mr-2"></i>
                <span class="font-hind text-sm">${message}</span>
              </div>
              <button onclick="this.parentElement.parentElement.style.display='none'" class="ml-2 text-lg font-bold hover:opacity-70">√ó</button>
            </div>
          `;

          notification.style.display = "block";

          // Auto-hide after 5 seconds for non-error messages
          if (type !== "error") {
            setTimeout(() => {
              if (notification) {
                notification.style.display = "none";
              }
            }, 5000);
          }
        }
        addEventListener(elementId, event, handler) {
          const element = document.getElementById(elementId);
          if (element) {
            element.addEventListener(event, handler);
            if (!this.eventListeners.has(elementId)) {
              this.eventListeners.set(elementId, []);
            }
            this.eventListeners.get(elementId).push({ event, handler });
          }
        }

        removeEventListeners(elementId) {
          const listeners = this.eventListeners.get(elementId);
          if (listeners) {
            const element = document.getElementById(elementId);
            if (element) {
              listeners.forEach(({ event, handler }) => {
                element.removeEventListener(event, handler);
              });
            }
            this.eventListeners.delete(elementId);
          }
        }
        handleFormSubmit(event) {
          event.preventDefault();

          try {
            // Clear previous error styles
            this.clearFormErrors();

            // Validate and collect form data
            const formData = this.validateFormData();
            if (!formData) return; // Validation failed

            this.testData = formData;
            this.showSection("test-section");
            this.generateTestInterface();
            this.startTimer();
          } catch (error) {
            console.error("Form submission error:", error);
            this.showError("‡¶´‡¶∞‡ßç‡¶Æ ‡¶ú‡¶Æ‡¶æ ‡¶¶‡ßá‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞ ‡¶∏‡¶Æ‡¶Ø‡¶º ‡¶è‡¶ï‡¶ü‡¶ø ‡¶§‡ßç‡¶∞‡ßÅ‡¶ü‡¶ø ‡¶ò‡¶ü‡ßá‡¶õ‡ßá‡•§");
          }
        }

        clearFormErrors() {
          const inputs = document.querySelectorAll("#test-form input");
          inputs.forEach((input) => {
            input.classList.remove("border-red-500");
            const errorDiv =
              input.parentElement.querySelector(".error-message");
            if (errorDiv) errorDiv.remove();
          });
        }

        showFieldError(fieldId, message) {
          const field = document.getElementById(fieldId);
          if (!field) return;

          field.classList.add("border-red-500");
          const errorDiv = document.createElement("div");
          errorDiv.className =
            "error-message text-red-600 text-sm mt-1 font-hind";
          errorDiv.textContent = message;
          field.parentElement.appendChild(errorDiv);
          field.focus();
        }

        showError(message) {
          alert(message);
        }

        validateFormData() {
          const name = document.getElementById("test-name").value.trim();
          const mcqNumber = document.getElementById("mcq-number").value.trim();
          const timeLimit = document.getElementById("time-limit").value.trim();
          const marksPerQuestion = document
            .getElementById("marks-per-question")
            .value.trim();
          const negativeMarkingValue = document
            .getElementById("negative-marking-value")
            .value.trim();

          // Test name validation
          if (!name) {
            this.showFieldError("test-name", "‡¶™‡¶∞‡ßÄ‡¶ï‡ßç‡¶∑‡¶æ‡¶∞ ‡¶®‡¶æ‡¶Æ ‡¶Ö‡¶¨‡¶∂‡ßç‡¶Ø‡¶á ‡¶¶‡¶ø‡¶§‡ßá ‡¶π‡¶¨‡ßá‡•§");
            return null;
          }
          if (name.length < 2) {
            this.showFieldError(
              "test-name",
              "‡¶™‡¶∞‡ßÄ‡¶ï‡ßç‡¶∑‡¶æ‡¶∞ ‡¶®‡¶æ‡¶Æ ‡¶ï‡¶Æ‡¶™‡¶ï‡ßç‡¶∑‡ßá ‡ß®‡¶ü‡¶ø ‡¶Ö‡¶ï‡ßç‡¶∑‡¶∞ ‡¶π‡¶§‡ßá ‡¶π‡¶¨‡ßá‡•§",
            );
            return null;
          }
          if (name.length > 100) {
            this.showFieldError(
              "test-name",
              "‡¶™‡¶∞‡ßÄ‡¶ï‡ßç‡¶∑‡¶æ‡¶∞ ‡¶®‡¶æ‡¶Æ ‡¶∏‡¶∞‡ßç‡¶¨‡ßã‡¶ö‡ßç‡¶ö ‡ßß‡ß¶‡ß¶ ‡¶Ö‡¶ï‡ßç‡¶∑‡¶∞ ‡¶π‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡ßá‡•§",
            );
            return null;
          }

          // MCQ number validation
          if (!mcqNumber) {
            this.showFieldError(
              "mcq-number",
              "‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶®‡ßá‡¶∞ ‡¶∏‡¶Ç‡¶ñ‡ßç‡¶Ø‡¶æ ‡¶Ö‡¶¨‡¶∂‡ßç‡¶Ø‡¶á ‡¶¶‡¶ø‡¶§‡ßá ‡¶π‡¶¨‡ßá‡•§",
            );
            return null;
          }
          const parsedMcqNumber = parseInt(mcqNumber);
          if (isNaN(parsedMcqNumber) || parsedMcqNumber < 1) {
            this.showFieldError(
              "mcq-number",
              "‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶®‡ßá‡¶∞ ‡¶∏‡¶Ç‡¶ñ‡ßç‡¶Ø‡¶æ ‡¶ï‡¶Æ‡¶™‡¶ï‡ßç‡¶∑‡ßá ‡ßß ‡¶π‡¶§‡ßá ‡¶π‡¶¨‡ßá‡•§",
            );
            return null;
          }
          if (parsedMcqNumber > 100) {
            this.showFieldError(
              "mcq-number",
              "‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶®‡ßá‡¶∞ ‡¶∏‡¶Ç‡¶ñ‡ßç‡¶Ø‡¶æ ‡¶∏‡¶∞‡ßç‡¶¨‡ßã‡¶ö‡ßç‡¶ö ‡ßß‡ß¶‡ß¶ ‡¶π‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡ßá‡•§",
            );
            return null;
          }

          // Time limit validation
          if (!timeLimit) {
            this.showFieldError("time-limit", "‡¶∏‡¶Æ‡¶Ø‡¶º‡¶∏‡ßÄ‡¶Æ‡¶æ ‡¶Ö‡¶¨‡¶∂‡ßç‡¶Ø‡¶á ‡¶¶‡¶ø‡¶§‡ßá ‡¶π‡¶¨‡ßá‡•§");
            return null;
          }
          const parsedTimeLimit = parseInt(timeLimit);
          if (isNaN(parsedTimeLimit) || parsedTimeLimit < 1) {
            this.showFieldError(
              "time-limit",
              "‡¶∏‡¶Æ‡¶Ø‡¶º‡¶∏‡ßÄ‡¶Æ‡¶æ ‡¶ï‡¶Æ‡¶™‡¶ï‡ßç‡¶∑‡ßá ‡ßß ‡¶Æ‡¶ø‡¶®‡¶ø‡¶ü ‡¶π‡¶§‡ßá ‡¶π‡¶¨‡ßá‡•§",
            );
            return null;
          }
          if (parsedTimeLimit > 300) {
            this.showFieldError(
              "time-limit",
              "‡¶∏‡¶Æ‡¶Ø‡¶º‡¶∏‡ßÄ‡¶Æ‡¶æ ‡¶∏‡¶∞‡ßç‡¶¨‡ßã‡¶ö‡ßç‡¶ö ‡ß©‡ß¶‡ß¶ ‡¶Æ‡¶ø‡¶®‡¶ø‡¶ü ‡¶π‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡ßá‡•§",
            );
            return null;
          }

          // Marks per question validation
          if (!marksPerQuestion) {
            this.showFieldError(
              "marks-per-question",
              "‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶® ‡¶™‡ßç‡¶∞‡¶§‡¶ø ‡¶®‡¶æ‡¶Æ‡ßç‡¶¨‡¶æ‡¶∞ ‡¶Ö‡¶¨‡¶∂‡ßç‡¶Ø‡¶á ‡¶¶‡¶ø‡¶§‡ßá ‡¶π‡¶¨‡ßá‡•§",
            );
            return null;
          }
          const parsedMarksPerQuestion = parseFloat(marksPerQuestion);
          if (isNaN(parsedMarksPerQuestion) || parsedMarksPerQuestion < 0) {
            this.showFieldError(
              "marks-per-question",
              "‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶® ‡¶™‡ßç‡¶∞‡¶§‡¶ø ‡¶®‡¶æ‡¶Æ‡ßç‡¶¨‡¶æ‡¶∞ ‡ß¶ ‡¶¨‡¶æ ‡¶§‡¶æ‡¶∞ ‡¶¨‡ßá‡¶∂‡¶ø ‡¶π‡¶§‡ßá ‡¶π‡¶¨‡ßá‡•§",
            );
            return null;
          }
          if (parsedMarksPerQuestion > 10) {
            this.showFieldError(
              "marks-per-question",
              "‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶® ‡¶™‡ßç‡¶∞‡¶§‡¶ø ‡¶®‡¶æ‡¶Æ‡ßç‡¶¨‡¶æ‡¶∞ ‡¶∏‡¶∞‡ßç‡¶¨‡ßã‡¶ö‡ßç‡¶ö ‡ßß‡ß¶ ‡¶π‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡ßá‡•§",
            );
            return null;
          }

          // Negative marking validation
          if (!negativeMarkingValue) {
            this.showFieldError(
              "negative-marking-value",
              "‡¶®‡ßá‡¶ó‡ßá‡¶ü‡¶ø‡¶≠ ‡¶Æ‡¶æ‡¶∞‡ßç‡¶ï‡¶ø‡¶Ç ‡¶Æ‡¶æ‡¶® ‡¶Ö‡¶¨‡¶∂‡ßç‡¶Ø‡¶á ‡¶¶‡¶ø‡¶§‡ßá ‡¶π‡¶¨‡ßá‡•§",
            );
            return null;
          }
          const parsedNegativeMarking = parseFloat(negativeMarkingValue);
          if (isNaN(parsedNegativeMarking) || parsedNegativeMarking < 0) {
            this.showFieldError(
              "negative-marking-value",
              "‡¶®‡ßá‡¶ó‡ßá‡¶ü‡¶ø‡¶≠ ‡¶Æ‡¶æ‡¶∞‡ßç‡¶ï‡¶ø‡¶Ç ‡¶Æ‡¶æ‡¶® ‡ß¶ ‡¶¨‡¶æ ‡¶§‡¶æ‡¶∞ ‡¶¨‡ßá‡¶∂‡¶ø ‡¶π‡¶§‡ßá ‡¶π‡¶¨‡ßá‡•§",
            );
            return null;
          }
          if (parsedNegativeMarking > parsedMarksPerQuestion) {
            this.showFieldError(
              "negative-marking-value",
              "‡¶®‡ßá‡¶ó‡ßá‡¶ü‡¶ø‡¶≠ ‡¶Æ‡¶æ‡¶∞‡ßç‡¶ï‡¶ø‡¶Ç ‡¶Æ‡¶æ‡¶® ‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶® ‡¶™‡ßç‡¶∞‡¶§‡¶ø ‡¶®‡¶æ‡¶Æ‡ßç‡¶¨‡¶æ‡¶∞‡ßá‡¶∞ ‡¶ö‡ßá‡¶Ø‡¶º‡ßá ‡¶¨‡ßá‡¶∂‡¶ø ‡¶π‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡ßá ‡¶®‡¶æ‡•§",
            );
            return null;
          }

          return {
            name: name,
            mcqNumber: parsedMcqNumber,
            timeLimit: parsedTimeLimit,
            marksPerQuestion: parsedMarksPerQuestion,
            negativeMarkingValue: parsedNegativeMarking,
          };
        }
        generateTestInterface() {
          this.generateTestDetails();
          this.generateMCQs();
          this.setupFloatingSummary();
        }

        generateTestDetails() {
          const testDetails = document.getElementById("test-details");
          if (!testDetails) return;

          testDetails.innerHTML = `
            <div class="bg-blue-50 p-3 sm:p-4 md:p-6 rounded-xl border border-blue-200">
              <h3 class="text-xl sm:text-2xl md:text-3xl font-bold text-blue-600 mb-4 sm:mb-6 text-center font-hind">
                <i class="fas fa-clipboard-list text-blue-600 mr-2 text-lg sm:text-xl md:text-2xl"></i>
                ${this.escapeHtml(this.testData.name)}
                <i class="fas fa-clipboard-list text-blue-600 ml-2 text-lg sm:text-xl md:text-2xl"></i>
              </h3>
              <div class="grid grid-cols-3 sm:grid-cols-4 gap-2 sm:gap-3 md:gap-4">
                <div class="bg-white p-2 sm:p-3 md:p-4 rounded-lg border border-blue-200 text-center shadow-sm hover:shadow-md transition-shadow">
                  <div class="bg-blue-500 text-white p-1.5 sm:p-2 rounded-full mb-1 sm:mb-2 inline-block">
                    <i class="fas fa-list text-sm sm:text-base md:text-lg"></i>
                  </div>
                  <div class="font-semibold text-gray-700 text-xs sm:text-sm mb-1 font-hind">‡¶Æ‡ßã‡¶ü ‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶®</div>
                  <div class="text-lg sm:text-xl md:text-2xl font-bold text-blue-600">${
                    this.testData.mcqNumber
                  }</div>
                </div>
                <div class="bg-white p-2 sm:p-3 md:p-4 rounded-lg border border-green-200 text-center shadow-sm hover:shadow-md transition-shadow">
                  <div class="bg-green-500 text-white p-1.5 sm:p-2 rounded-full mb-1 sm:mb-2 inline-block">
                    <i class="fas fa-hourglass-half text-sm sm:text-base md:text-lg"></i>
                  </div>
                  <div class="font-semibold text-gray-700 text-xs sm:text-sm mb-1 font-hind">‡¶∏‡¶Æ‡¶Ø‡¶º‡¶∏‡ßÄ‡¶Æ‡¶æ</div>
                  <div class="text-lg sm:text-xl md:text-2xl font-bold text-green-600">${
                    this.testData.timeLimit
                  } ‡¶Æ‡¶ø‡¶®‡¶ø‡¶ü</div>
                </div>
                <div class="bg-white p-2 sm:p-3 md:p-4 rounded-lg border border-yellow-200 text-center shadow-sm hover:shadow-md transition-shadow">
                  <div class="bg-yellow-500 text-white p-1.5 sm:p-2 rounded-full mb-1 sm:mb-2 inline-block">
                    <i class="fas fa-star text-sm sm:text-base md:text-lg"></i>
                  </div>
                  <div class="font-semibold text-gray-700 text-xs sm:text-sm mb-1 font-hind">‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶® ‡¶™‡ßç‡¶∞‡¶§‡¶ø ‡¶®‡¶æ‡¶Æ‡ßç‡¶¨‡¶æ‡¶∞</div>
                  <div class="text-lg sm:text-xl md:text-2xl font-bold text-yellow-600">${
                    this.testData.marksPerQuestion
                  }</div>
                </div>
                <div class="bg-white p-2 sm:p-3 md:p-4 rounded-lg border border-red-200 text-center shadow-sm hover:shadow-md transition-shadow col-span-3 sm:col-span-1">
                  <div class="bg-red-500 text-white p-1.5 sm:p-2 rounded-full mb-1 sm:mb-2 inline-block">
                    <i class="fas fa-exclamation-triangle text-sm sm:text-base md:text-lg"></i>
                  </div>
                  <div class="font-semibold text-gray-700 text-xs sm:text-sm mb-1 font-hind">‡¶®‡ßá‡¶ó‡ßá‡¶ü‡¶ø‡¶≠ ‡¶Æ‡¶æ‡¶∞‡ßç‡¶ï‡¶ø‡¶Ç</div>
                  <div class="text-lg sm:text-xl md:text-2xl font-bold text-red-600">${
                    this.testData.negativeMarkingValue > 0
                      ? this.testData.negativeMarkingValue
                      : "‡¶¨‡¶®‡ßç‡¶ß"
                  }</div>
                </div>
              </div>
            </div>
          `;
        }

        generateMCQs() {
          this.setLoadingState(true, "‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶® ‡¶§‡ßà‡¶∞‡¶ø ‡¶ï‡¶∞‡¶æ ‡¶π‡¶ö‡ßç‡¶õ‡ßá...");

          const mcqContainer = document.getElementById("mcq-container");
          if (!mcqContainer) {
            this.setLoadingState(false);
            return;
          }

          // Clear container efficiently
          mcqContainer.innerHTML = "";

          // Check for saved test progress
          const savedProgress = this.safeLocalStorageGet(
            "currentTestProgress",
            null,
          );
          const savedAnswers =
            savedProgress && savedProgress.testName === this.testData.name
              ? savedProgress.answers
              : {};

          try {
            // Use document fragment for better performance
            const fragment = document.createDocumentFragment();
            const batchSize = 20; // Process questions in batches for large numbers
            let currentBatch = 0;

            const processBatch = () => {
              const startIndex = currentBatch * batchSize + 1;
              const endIndex = Math.min(
                (currentBatch + 1) * batchSize,
                this.testData.mcqNumber,
              );

              for (let i = startIndex; i <= endIndex; i++) {
                this.updateLoadingProgress((i / this.testData.mcqNumber) * 100);

                const mcqDiv = this.createMCQElement(i, savedAnswers[i] || "");
                fragment.appendChild(mcqDiv);
              }

              // Append current batch to container
              if (currentBatch === 0 || endIndex === this.testData.mcqNumber) {
                mcqContainer.appendChild(fragment);
              }

              currentBatch++;

              // Continue with next batch or finish
              if (endIndex < this.testData.mcqNumber) {
                // Use requestAnimationFrame for smooth UI updates
                requestAnimationFrame(processBatch);
              } else {
                // All questions processed
                this.setupMCQEventListeners();
                this.setLoadingState(false);
                this.refreshCache();
                this.showUserMessage("‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶® ‡¶§‡ßà‡¶∞‡¶ø ‡¶∏‡¶Æ‡ßç‡¶™‡¶®‡ßç‡¶®!", "success");
              }
            };

            // Start processing
            requestAnimationFrame(processBatch);
          } catch (error) {
            console.error("Error generating MCQs:", error);
            this.setLoadingState(false);
            this.showUserMessage("‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶® ‡¶§‡ßà‡¶∞‡¶ø‡¶§‡ßá ‡¶∏‡¶Æ‡¶∏‡ßç‡¶Ø‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá‡•§", "error");
          }
        }

        // Optimized MCQ element creation
        createMCQElement(questionNumber, savedAnswer = "") {
          const mcqDiv = document.createElement("div");
          mcqDiv.className =
            "flex flex-col md:flex-row md:items-center justify-between mb-2 sm:mb-3 md:mb-4 lg:mb-5 gap-2 sm:gap-3 md:gap-4 p-2 sm:p-3 md:p-4 lg:p-5 border border-white/30 rounded-lg sm:rounded-xl bg-white/80 glass-morphism shadow-md sm:shadow-lg transition-all duration-300 hover:shadow-lg sm:hover:shadow-xl hover:-translate-y-0.5 mobile-mcq-option touch-spacing";
          mcqDiv.setAttribute("id", `mcq-${questionNumber}`);
          mcqDiv.setAttribute("data-question", questionNumber);

          const checkedA = savedAnswer === "A" ? "checked" : "";
          const checkedB = savedAnswer === "B" ? "checked" : "";
          const checkedC = savedAnswer === "C" ? "checked" : "";
          const checkedD = savedAnswer === "D" ? "checked" : "";

          // Use template literal with optimized HTML structure
          mcqDiv.innerHTML = `
            <p class="flex-1 md:mr-4 font-semibold text-gray-700 mb-1 sm:mb-2 md:mb-0 min-w-0 font-hind text-xs sm:text-sm md:text-base">
              <i class="fas fa-question-circle text-blue-600 mr-1 sm:mr-2 text-xs sm:text-sm icon-sharp" aria-hidden="true"></i>
              ‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶® ${questionNumber}:
            </p>
            <div class="flex gap-1 sm:gap-2 md:gap-3 flex-wrap md:flex-nowrap items-center justify-center sm:justify-start" role="radiogroup" aria-label="‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶® ${questionNumber} ‡¶è‡¶∞ ‡¶Ö‡¶™‡¶∂‡¶®">
              ${this.createRadioOption(questionNumber, "A", checkedA)}
              ${this.createRadioOption(questionNumber, "B", checkedB)}
              ${this.createRadioOption(questionNumber, "C", checkedC)}
              ${this.createRadioOption(questionNumber, "D", checkedD)}
            </div>
          `;

          return mcqDiv;
        }

        // Reusable radio option creation
        createRadioOption(questionNumber, option, checked) {
          return `<input type="radio" name="q${questionNumber}" value="${option}" 
                    class="radio-custom w-4 h-4 sm:w-5 sm:h-5 md:w-6 md:h-6 relative m-0.5 sm:m-1 md:m-2 cursor-pointer appearance-none border-2 border-gray-300 rounded-full bg-white transition-all duration-300 hover:border-blue-600 hover:scale-105 focus:outline-2 focus:outline-blue-600 focus:outline-offset-2 min-w-[16px] sm:min-w-[20px] md:min-w-[24px] flex-shrink-0 touch-target touch-optimize mobile-mcq-option" 
                    ${checked} aria-label="‡¶Ö‡¶™‡¶∂‡¶® ${option}" data-question="${questionNumber}" data-option="${option}">`;
        }

        // Optimized event listener setup
        setupMCQEventListeners() {
          try {
            // Use event delegation for better performance
            const mcqContainer = document.getElementById("mcq-container");
            if (!mcqContainer) return;

            // Single event listener for all radio buttons using delegation
            const radioHandler = (e) => {
              if (e.target.type === "radio") {
                const questionNumber = e.target.dataset.question;
                const option = e.target.dataset.option;

                // Auto-save answer
                this.saveCurrentProgress();

                // Update summary if visible
                if (this.summaryVisible) {
                  const summaryContent =
                    document.getElementById("summary-content");
                  if (summaryContent) {
                    this.updateSummary(summaryContent);
                  }
                }

                // Update answered count
                this.updateAnsweredCounts();
              }
            };

            // Remove old listener if exists
            const oldHandler = this.eventListeners.get("mcq-container-change");
            if (oldHandler) {
              mcqContainer.removeEventListener("change", oldHandler);
            }

            // Add new optimized listener
            mcqContainer.addEventListener("change", radioHandler, {
              passive: true,
            });
            this.eventListeners.set("mcq-container-change", radioHandler);
          } catch (error) {
            console.error("Error setting up MCQ event listeners:", error);
          }
        }

        // Debounced answer count update for performance
        updateAnsweredCounts() {
          if (this.countUpdateTimeout) {
            clearTimeout(this.countUpdateTimeout);
          }

          this.countUpdateTimeout = setTimeout(() => {
            try {
              const answeredCount = document.getElementById("answered-count");
              const floatingAnsweredCount = document.getElementById(
                "floating-answered-count",
              );

              if (!answeredCount && !floatingAnsweredCount) return;

              let answered = 0;
              for (let i = 1; i <= this.testData.mcqNumber; i++) {
                if (document.querySelector(`input[name="q${i}"]:checked`)) {
                  answered++;
                }
              }

              if (answeredCount) answeredCount.textContent = answered;
              if (floatingAnsweredCount)
                floatingAnsweredCount.textContent = answered;

              // Update progress indicator
              this.updateProgressIndicator(answered);
            } catch (error) {
              console.error("Error updating answered counts:", error);
            }
          }, 100); // Debounce by 100ms
        }

        // Optimized progress indicator update
        updateProgressIndicator(answeredCount) {
          try {
            const floatingButton =
              this.getCachedElement("floating-summary") ||
              document.getElementById("floating-summary");
            const floatingAnsweredCount = document.getElementById(
              "floating-answered-count",
            );

            if (!floatingButton) return;

            const percentage = Math.round(
              (answeredCount / this.testData.mcqNumber) * 100,
            );
            floatingButton.setAttribute(
              "title",
              `${percentage}% ‡¶∏‡¶Æ‡ßç‡¶™‡ßÇ‡¶∞‡ßç‡¶£ (${answeredCount}/${this.testData.mcqNumber})`,
            );

            // Update button color based on progress
            floatingButton.classList.remove(
              "bg-gray-500",
              "bg-yellow-500",
              "bg-blue-500",
              "bg-green-500",
            );

            let badgeColor = "bg-red-500";
            if (percentage === 100) {
              floatingButton.classList.add("bg-green-500");
              badgeColor = "bg-green-500";
            } else if (percentage >= 75) {
              floatingButton.classList.add("bg-blue-500");
              badgeColor = "bg-blue-500";
            } else if (percentage >= 50) {
              floatingButton.classList.add("bg-yellow-500");
              badgeColor = "bg-yellow-500";
            } else {
              floatingButton.classList.add("bg-gray-500");
            }

            // Update badge color
            if (floatingAnsweredCount && floatingAnsweredCount.parentElement) {
              floatingAnsweredCount.parentElement.className = `absolute -top-2 -right-2 w-6 h-6 ${badgeColor} text-white text-xs rounded-full flex items-center justify-center font-bold`;
            }
          } catch (error) {
            console.error("Error updating progress indicator:", error);
          }
        }

        setupFloatingSummary() {
          const floatingSummary = document.getElementById("floating-summary");
          if (!floatingSummary) return;

          const summaryContent = document.createElement("div");
          summaryContent.id = "summary-content";
          summaryContent.className =
            "fixed bottom-16 left-2 sm:bottom-20 sm:left-5 w-48 sm:w-56 max-h-48 sm:max-h-56 p-3 sm:p-4 bg-white border-2 border-green-500 rounded-xl shadow-2xl overflow-y-auto z-50 transform transition-all duration-300 mobile-summary-position";
          summaryContent.style.display = "none";
          summaryContent.style.backdropFilter = "blur(6px)";
          summaryContent.style.webkitBackdropFilter = "blur(6px)";
          summaryContent.style.backgroundColor = "rgba(255, 255, 255, 0.95)";
          summaryContent.style.boxShadow =
            "0 10px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04)";
          summaryContent.setAttribute("role", "dialog");
          summaryContent.setAttribute(
            "aria-label",
            "‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶®‡ßá‡¶∞ ‡¶∏‡¶Ç‡¶ï‡ßç‡¶∑‡¶ø‡¶™‡ßç‡¶§‡¶∏‡¶æ‡¶∞ ‡¶è‡¶¨‡¶Ç ‡¶Ö‡¶ó‡ßç‡¶∞‡¶ó‡¶§‡¶ø",
          );
          summaryContent.setAttribute(
            "aria-describedby",
            "summary-progress-info",
          );
          document.body.appendChild(summaryContent);

          // Enhanced progress tracking
          let lastAnsweredCount = 0;
          let isVisible = false;

          const updateAnsweredCount = () => {
            const answeredCount = document.getElementById("answered-count");
            const floatingAnsweredCount = document.getElementById(
              "floating-answered-count",
            );
            const floatingButton = document.getElementById("floating-summary");

            if (answeredCount || floatingAnsweredCount) {
              let answered = 0;
              let flagged = 0;

              for (let i = 1; i <= this.testData.mcqNumber; i++) {
                if (document.querySelector(`input[name="q${i}"]:checked`)) {
                  answered++;
                }
                // Check for flagged questions (if you implement flagging)
                if (this.flaggedQuestions && this.flaggedQuestions.has(i)) {
                  flagged++;
                }
              }

              if (answeredCount) answeredCount.textContent = answered;
              if (floatingAnsweredCount)
                floatingAnsweredCount.textContent = answered;

              // Update floating button with progress indication
              if (floatingButton) {
                const percentage = Math.round(
                  (answered / this.testData.mcqNumber) * 100,
                );
                floatingButton.setAttribute(
                  "title",
                  `${percentage}% ‡¶∏‡¶Æ‡ßç‡¶™‡ßÇ‡¶∞‡ßç‡¶£ (${answered}/${this.testData.mcqNumber})`,
                );

                // Change button appearance based on progress
                floatingButton.className = floatingButton.className.replace(
                  /bg-\w+-\d+/,
                  "",
                );
                if (percentage === 100) {
                  floatingButton.classList.add("bg-green-500", "animate-pulse");
                  if (floatingAnsweredCount) {
                    floatingAnsweredCount.parentElement.className =
                      "absolute -top-2 -right-2 w-6 h-6 bg-green-500 text-white text-xs rounded-full flex items-center justify-center font-bold";
                  }
                } else if (percentage >= 75) {
                  floatingButton.classList.add("bg-blue-500");
                  if (floatingAnsweredCount) {
                    floatingAnsweredCount.parentElement.className =
                      "absolute -top-2 -right-2 w-6 h-6 bg-blue-500 text-white text-xs rounded-full flex items-center justify-center font-bold";
                  }
                } else if (percentage >= 50) {
                  floatingButton.classList.add("bg-yellow-500");
                  if (floatingAnsweredCount) {
                    floatingAnsweredCount.parentElement.className =
                      "absolute -top-2 -right-2 w-6 h-6 bg-yellow-500 text-white text-xs rounded-full flex items-center justify-center font-bold";
                  }
                } else {
                  floatingButton.classList.add("bg-gray-500");
                  if (floatingAnsweredCount) {
                    floatingAnsweredCount.parentElement.className =
                      "absolute -top-2 -right-2 w-6 h-6 bg-red-500 text-white text-xs rounded-full flex items-center justify-center font-bold";
                  }
                }

                // Show notification when progress milestones are reached
                if (answered > lastAnsweredCount) {
                  if (
                    answered === this.testData.mcqNumber &&
                    answered > lastAnsweredCount
                  ) {
                    this.showUserMessage(
                      "‡¶∏‡¶¨ ‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶®‡ßá‡¶∞ ‡¶â‡¶§‡ßç‡¶§‡¶∞ ‡¶¶‡ßá‡¶ì‡¶Ø‡¶º‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá! ‡¶ö‡ßÇ‡¶°‡¶º‡¶æ‡¶®‡ßç‡¶§ ‡¶™‡¶∞‡ßç‡¶Ø‡¶æ‡¶≤‡ßã‡¶ö‡¶®‡¶æ ‡¶ï‡¶∞‡ßÅ‡¶®‡•§",
                      "success",
                    );
                  } else if (
                    percentage === 50 &&
                    lastAnsweredCount < this.testData.mcqNumber / 2
                  ) {
                    this.showUserMessage(
                      "‡¶Ö‡¶∞‡ßç‡¶ß‡ßá‡¶ï ‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶® ‡¶∏‡¶Æ‡ßç‡¶™‡ßÇ‡¶∞‡ßç‡¶£! ‡¶ö‡¶æ‡¶≤‡¶ø‡¶Ø‡¶º‡ßá ‡¶Ø‡¶æ‡¶®‡•§",
                      "info",
                    );
                  } else if (
                    percentage === 75 &&
                    lastAnsweredCount < this.testData.mcqNumber * 0.75
                  ) {
                    this.showUserMessage(
                      "‡ß≠‡ß´% ‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶® ‡¶∏‡¶Æ‡ßç‡¶™‡ßÇ‡¶∞‡ßç‡¶£! ‡¶™‡ßç‡¶∞‡¶æ‡¶Ø‡¶º ‡¶∂‡ßá‡¶∑‡•§",
                      "info",
                    );
                  }
                }

                lastAnsweredCount = answered;
              }

              // Update summary if visible
              if (isVisible) {
                this.updateSummary(summaryContent);
              }
            }
          };

          // Enhanced floating button click with animation
          this.addEventListener("floating-summary", "click", (e) => {
            e.preventDefault();
            e.stopPropagation();

            isVisible = !isVisible;
            const button = e.currentTarget;

            // Add click animation
            button.style.transform = "scale(0.95)";
            setTimeout(() => {
              button.style.transform = "scale(1)";
            }, 150);

            if (isVisible) {
              summaryContent.style.display = "block";
              summaryContent.style.opacity = "0";
              summaryContent.style.transform = "translateY(20px) scale(0.95)";

              setTimeout(() => {
                summaryContent.style.opacity = "1";
                summaryContent.style.transform = "translateY(0) scale(1)";
              }, 10);

              this.updateSummary(summaryContent);

              // Focus management for accessibility
              const firstQuestion =
                summaryContent.querySelector('[tabindex="0"]');
              if (firstQuestion) {
                firstQuestion.focus();
              }
            } else {
              summaryContent.style.opacity = "0";
              summaryContent.style.transform = "translateY(20px) scale(0.95)";

              setTimeout(() => {
                summaryContent.style.display = "none";
              }, 300);

              // Return focus to floating button
              button.focus();
            }
          });

          // Enhanced keyboard navigation
          this.addEventListener("floating-summary", "keydown", (e) => {
            if (e.key === "Enter" || e.key === " ") {
              e.preventDefault();
              e.stopPropagation();
              floatingSummary.click();
            } else if (e.key === "Escape" && isVisible) {
              e.preventDefault();
              floatingSummary.click(); // Close summary
            }
          });

          // Close summary when clicking outside
          document.addEventListener("click", (e) => {
            if (
              isVisible &&
              !summaryContent.contains(e.target) &&
              e.target !== floatingSummary
            ) {
              floatingSummary.click();
            }
          });

          // Update answered count when radio buttons change
          for (let i = 1; i <= this.testData.mcqNumber; i++) {
            const radioButtons = document.querySelectorAll(
              `input[name="q${i}"]`,
            );
            radioButtons.forEach((radio) => {
              radio.addEventListener("change", updateAnsweredCount);
            });
          }

          // Initialize flagged questions set
          this.flaggedQuestions = this.flaggedQuestions || new Set();

          // Initial count update
          updateAnsweredCount();
        }

        updateSummary(container) {
          if (!container) return;

          try {
            container.innerHTML = "";

            // Create header with progress information
            const header = document.createElement("div");
            header.className = "mb-3 pb-2 border-b border-gray-200";

            let answered = 0;
            let unanswered = 0;
            let flagged = this.flaggedQuestions
              ? this.flaggedQuestions.size
              : 0;

            // Count answered questions
            for (let i = 1; i <= this.testData.mcqNumber; i++) {
              if (document.querySelector(`input[name="q${i}"]:checked`)) {
                answered++;
              } else {
                unanswered++;
              }
            }

            const percentage = Math.round(
              (answered / this.testData.mcqNumber) * 100,
            );

            header.innerHTML = `
              <div class="flex items-center justify-between mb-2">
                <h4 class="font-bold text-sm text-gray-800 font-hind">‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶® ‡¶∏‡¶Ç‡¶ï‡ßç‡¶∑‡¶ø‡¶™‡ßç‡¶§‡¶∏‡¶æ‡¶∞</h4>
                <span class="text-xs text-gray-600 font-bold">${percentage}%</span>
              </div>
              <div class="w-full bg-gray-200 rounded-full h-2 mb-2 overflow-hidden">
                <div class="h-2 rounded-full transition-all duration-500 ${
                  percentage === 100
                    ? "bg-green-500"
                    : percentage >= 75
                      ? "bg-blue-500"
                      : percentage >= 50
                        ? "bg-yellow-500"
                        : "bg-red-500"
                }" style="width: ${percentage}%"></div>
              </div>
              <div class="flex justify-between text-xs font-hind">
                <span class="text-green-600">
                  <i class="fas fa-check-circle mr-1"></i>${answered} ‡¶∏‡¶Æ‡ßç‡¶™‡ßÇ‡¶∞‡ßç‡¶£
                </span>
                <span class="text-gray-500">
                  <i class="fas fa-clock mr-1"></i>${unanswered} ‡¶¨‡¶æ‡¶ï‡¶ø
                </span>
                ${flagged > 0 ? `<span class="text-yellow-600"><i class="fas fa-flag mr-1"></i>${flagged} ‡¶´‡ßç‡¶≤‡ßç‡¶Ø‡¶æ‡¶ó</span>` : ""}
              </div>
            `;

            container.appendChild(header);

            // Create questions grid with enhanced visual feedback
            const questionsGrid = document.createElement("div");
            questionsGrid.className = "grid grid-cols-6 gap-1";
            questionsGrid.setAttribute("role", "grid");
            questionsGrid.setAttribute("aria-label", "‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶®‡ßá‡¶∞ ‡¶§‡¶æ‡¶≤‡¶ø‡¶ï‡¶æ");

            for (let i = 1; i <= this.testData.mcqNumber; i++) {
              const isAnswered = document.querySelector(
                `input[name="q${i}"]:checked`,
              );
              const isFlagged =
                this.flaggedQuestions && this.flaggedQuestions.has(i);
              const isCurrentQuestion = this.isQuestionInViewport(i);

              // Determine question status and styling
              let statusClass, statusIcon, statusText, bgColor, textColor;

              if (isAnswered) {
                statusClass = "answered";
                statusIcon = "fas fa-check";
                statusText = "‡¶â‡¶§‡ßç‡¶§‡¶∞‡¶ø‡¶§";
                bgColor = "#10b981"; // green
                textColor = "white";
              } else {
                statusClass = "unanswered";
                statusIcon = "fas fa-question";
                statusText = "‡¶Ö‡¶®‡ßÅ‡¶§‡ßç‡¶§‡¶∞‡¶ø‡¶§";
                bgColor = "#e5e7eb"; // gray
                textColor = "#374151";
              }

              if (isFlagged) {
                statusIcon = "fas fa-flag";
                bgColor = "#f59e0b"; // yellow
                textColor = "white";
                statusText = "‡¶´‡ßç‡¶≤‡ßç‡¶Ø‡¶æ‡¶ó‡¶ï‡ßÉ‡¶§";
              }

              const questionBox = document.createElement("div");
              questionBox.className = `relative inline-flex items-center justify-center w-8 h-8 m-0.5 border-2 text-center cursor-pointer rounded-lg font-bold transition-all duration-300 hover:scale-110 text-xs ${isCurrentQuestion ? "ring-2 ring-blue-400 ring-offset-1" : ""}`;
              questionBox.textContent = i;
              questionBox.setAttribute("role", "gridcell");
              questionBox.setAttribute(
                "aria-label",
                `‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶® ${i} - ${statusText}${isFlagged ? " (‡¶´‡ßç‡¶≤‡ßç‡¶Ø‡¶æ‡¶ó‡¶ï‡ßÉ‡¶§)" : ""}`,
              );
              questionBox.setAttribute("tabindex", "0");
              questionBox.setAttribute("data-question", i);
              questionBox.style.backgroundColor = bgColor;
              questionBox.style.color = textColor;
              questionBox.style.borderColor = isCurrentQuestion
                ? "#3b82f6"
                : isAnswered
                  ? "#10b981"
                  : "#d1d5db";

              // Add status indicator
              if (isAnswered || isFlagged) {
                const indicator = document.createElement("i");
                indicator.className = `${statusIcon} absolute -top-1 -right-1 text-xs`;
                indicator.style.fontSize = "8px";
                questionBox.appendChild(indicator);
              }

              // Enhanced click interaction with visual feedback
              questionBox.addEventListener("click", (e) => {
                e.preventDefault();

                // Visual feedback
                questionBox.style.transform = "scale(0.9)";
                setTimeout(() => {
                  questionBox.style.transform = "scale(1.1)";
                  setTimeout(() => {
                    questionBox.style.transform = "scale(1)";
                  }, 100);
                }, 100);

                // Smooth scroll to question
                const targetQuestion = document.getElementById(`mcq-${i}`);
                if (targetQuestion) {
                  targetQuestion.scrollIntoView({
                    behavior: "smooth",
                    block: "center",
                  });

                  // Highlight the target question temporarily
                  targetQuestion.style.backgroundColor = "#fef3c7";
                  targetQuestion.style.transition =
                    "background-color 0.3s ease";
                  setTimeout(() => {
                    targetQuestion.style.backgroundColor = "";
                  }, 2000);

                  // Focus on the first radio button of the question for accessibility
                  setTimeout(() => {
                    const firstRadio = targetQuestion.querySelector(
                      'input[type="radio"]',
                    );
                    if (firstRadio && !isAnswered) {
                      firstRadio.focus();
                    }
                  }, 500);
                }
              });

              // Enhanced keyboard navigation
              questionBox.addEventListener("keydown", (e) => {
                if (e.key === "Enter" || e.key === " ") {
                  e.preventDefault();
                  questionBox.click();
                } else if (e.key === "f" || e.key === "F") {
                  // Flag/unflag question with 'F' key
                  e.preventDefault();
                  this.toggleQuestionFlag(i);
                  this.updateSummary(container); // Refresh summary
                } else if (e.key === "ArrowRight" || e.key === "ArrowDown") {
                  e.preventDefault();
                  const nextBox = questionsGrid.querySelector(
                    `[data-question="${i + 1}"]`,
                  );
                  if (nextBox) nextBox.focus();
                } else if (e.key === "ArrowLeft" || e.key === "ArrowUp") {
                  e.preventDefault();
                  const prevBox = questionsGrid.querySelector(
                    `[data-question="${i - 1}"]`,
                  );
                  if (prevBox) prevBox.focus();
                }
              });

              // Hover effects
              questionBox.addEventListener("mouseenter", () => {
                questionBox.style.transform = "scale(1.05)";
                questionBox.style.boxShadow = "0 4px 8px rgba(0,0,0,0.15)";
              });

              questionBox.addEventListener("mouseleave", () => {
                questionBox.style.transform = "scale(1)";
                questionBox.style.boxShadow = "none";
              });

              questionsGrid.appendChild(questionBox);
            }

            container.appendChild(questionsGrid);

            // Add footer with quick actions
            const footer = document.createElement("div");
            footer.className =
              "mt-3 pt-2 border-t border-gray-200 flex justify-between text-xs font-hind";
            footer.innerHTML = `
              <button class="px-2 py-1 bg-blue-500 text-white rounded hover:bg-blue-600 transition-colors" onclick="app.scrollToFirstUnanswered()">
                <i class="fas fa-arrow-right mr-1"></i>‡¶™‡¶∞‡¶¨‡¶∞‡ßç‡¶§‡ßÄ ‡¶Ö‡¶®‡ßÅ‡¶§‡ßç‡¶§‡¶∞‡¶ø‡¶§
              </button>
              <button class="px-2 py-1 bg-gray-500 text-white rounded hover:bg-gray-600 transition-colors" onclick="document.getElementById('floating-summary').click()">
                <i class="fas fa-times mr-1"></i>‡¶¨‡¶®‡ßç‡¶ß
              </button>
            `;

            container.appendChild(footer);

            // Add keyboard shortcut info
            const shortcuts = document.createElement("div");
            shortcuts.className = "mt-2 text-xs text-gray-500 font-hind";
            shortcuts.innerHTML = `<i class="fas fa-info-circle mr-1"></i>‡¶ü‡¶ø‡¶™‡¶∏: F=‡¶´‡ßç‡¶≤‡ßç‡¶Ø‡¶æ‡¶ó, ESC=‡¶¨‡¶®‡ßç‡¶ß, ‡¶§‡ßÄ‡¶∞=‡¶®‡ßá‡¶≠‡¶ø‡¶ó‡ßá‡¶ü`;
            container.appendChild(shortcuts);
          } catch (error) {
            console.error("Error updating summary:", error);
            container.innerHTML =
              '<div class="text-red-500 text-center p-2 font-hind">‡¶∏‡¶Ç‡¶ï‡ßç‡¶∑‡¶ø‡¶™‡ßç‡¶§‡¶∏‡¶æ‡¶∞ ‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡¶§‡ßá ‡¶∏‡¶Æ‡¶∏‡ßç‡¶Ø‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá</div>';
          }
        }

        isQuestionInViewport(questionNumber) {
          try {
            const questionElement = document.getElementById(
              `mcq-${questionNumber}`,
            );
            if (!questionElement) return false;

            const rect = questionElement.getBoundingClientRect();
            return rect.top >= 0 && rect.bottom <= window.innerHeight;
          } catch (error) {
            return false;
          }
        }

        toggleQuestionFlag(questionNumber) {
          try {
            if (!this.flaggedQuestions) {
              this.flaggedQuestions = new Set();
            }

            if (this.flaggedQuestions.has(questionNumber)) {
              this.flaggedQuestions.delete(questionNumber);
              this.showUserMessage(
                `‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶® ${questionNumber} ‡¶•‡ßá‡¶ï‡ßá ‡¶´‡ßç‡¶≤‡ßç‡¶Ø‡¶æ‡¶ó ‡¶∏‡¶∞‡¶æ‡¶®‡ßã ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá`,
                "info",
              );
            } else {
              this.flaggedQuestions.add(questionNumber);
              this.showUserMessage(
                `‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶® ${questionNumber} ‡¶´‡ßç‡¶≤‡ßç‡¶Ø‡¶æ‡¶ó ‡¶ï‡¶∞‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá`,
                "info",
              );
            }

            // Save flagged questions
            this.safeLocalStorageSet(
              "flaggedQuestions",
              Array.from(this.flaggedQuestions),
            );
          } catch (error) {
            console.error("Error toggling flag:", error);
            this.showUserMessage("‡¶´‡ßç‡¶≤‡ßç‡¶Ø‡¶æ‡¶ó ‡¶ü‡¶ó‡¶≤ ‡¶ï‡¶∞‡¶§‡ßá ‡¶∏‡¶Æ‡¶∏‡ßç‡¶Ø‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá", "error");
          }
        }

        scrollToFirstUnanswered() {
          try {
            for (let i = 1; i <= this.testData.mcqNumber; i++) {
              if (!document.querySelector(`input[name="q${i}"]:checked`)) {
                const questionElement = document.getElementById(`mcq-${i}`);
                if (questionElement) {
                  questionElement.scrollIntoView({
                    behavior: "smooth",
                    block: "center",
                  });

                  // Close summary after navigation
                  const floatingButton =
                    document.getElementById("floating-summary");
                  if (floatingButton) {
                    setTimeout(() => floatingButton.click(), 500);
                  }

                  // Focus on first radio button
                  setTimeout(() => {
                    const firstRadio = questionElement.querySelector(
                      'input[type="radio"]',
                    );
                    if (firstRadio) firstRadio.focus();
                  }, 800);

                  return;
                }
              }
            }
            this.showUserMessage("‡¶∏‡¶¨ ‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶®‡ßá‡¶∞ ‡¶â‡¶§‡ßç‡¶§‡¶∞ ‡¶¶‡ßá‡¶ì‡¶Ø‡¶º‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá!", "success");
          } catch (error) {
            console.error("Error scrolling to unanswered:", error);
            this.showUserMessage("‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶®‡ßá ‡¶Ø‡ßá‡¶§‡ßá ‡¶∏‡¶Æ‡¶∏‡ßç‡¶Ø‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá", "error");
          }
        }
        startTimer() {
          const timerDisplay = document.getElementById("timer");
          const timerCompact = document.getElementById("timer-compact");
          const answeredCount = document.getElementById("answered-count");
          if (!timerDisplay || !timerCompact) return;

          // Check for saved timer progress, otherwise use initial time limit
          const savedTimerData = this.safeLocalStorageGet(
            "currentTestTimer",
            null,
          );
          let timeRemaining;

          if (
            savedTimerData &&
            savedTimerData.testName === this.testData.name
          ) {
            timeRemaining = savedTimerData.remainingTime;
          } else {
            timeRemaining = this.testData.timeLimit * 60;
          }

          if (this.timer) {
            clearInterval(this.timer);
          }

          const updateAnsweredCount = () => {
            if (answeredCount) {
              let answered = 0;
              for (let i = 1; i <= this.testData.mcqNumber; i++) {
                if (document.querySelector(`input[name="q${i}"]:checked`)) {
                  answered++;
                }
              }
              answeredCount.textContent = answered;
            }
          };

          this.timer = setInterval(() => {
            const minutes = Math.floor(timeRemaining / 60);
            const seconds = timeRemaining % 60;
            const timeString = `${minutes.toString().padStart(2, "0")}:${seconds
              .toString()
              .padStart(2, "0")}`;

            if (timerDisplay)
              timerDisplay.textContent = `‡¶Ö‡¶¨‡¶∂‡¶ø‡¶∑‡ßç‡¶ü ‡¶∏‡¶Æ‡¶Ø‡¶º: ${minutes}‡¶Æ‡¶ø ${seconds}‡¶∏‡ßá`;
            if (timerCompact) timerCompact.textContent = timeString;
            updateAnsweredCount();

            // Save timer progress to localStorage
            const timerData = {
              testName: this.testData.name,
              remainingTime: timeRemaining,
              timestamp: Date.now(),
            };
            this.safeLocalStorageSet("currentTestTimer", timerData);

            timeRemaining--;

            if (timeRemaining < 0) {
              clearInterval(this.timer);
              // Clear saved timer data when time is up
              this.safeLocalStorageSet("currentTestTimer", null);
              if (timerDisplay) timerDisplay.textContent = "‡¶∏‡¶Æ‡¶Ø‡¶º ‡¶∂‡ßá‡¶∑!";
              if (timerDisplay) timerDisplay.classList.add("bg-red-500");
              if (timerDisplay)
                timerDisplay.classList.remove("bg-gradient-accent");
              alert("‡¶∏‡¶Æ‡¶Ø‡¶º ‡¶∂‡ßá‡¶∑! ‡¶™‡¶∞‡ßÄ‡¶ï‡ßç‡¶∑‡¶æ ‡¶∏‡ßç‡¶¨‡¶Ø‡¶º‡¶Ç‡¶ï‡ßç‡¶∞‡¶ø‡¶Ø‡¶º‡¶≠‡¶æ‡¶¨‡ßá ‡¶ú‡¶Æ‡¶æ ‡¶¶‡ßá‡¶ì‡¶Ø‡¶º‡¶æ ‡¶π‡¶¨‡ßá‡•§");
              this.submitTest();
            }
          }, 1000);

          // Initial update
          updateAnsweredCount();
        }
        submitTest() {
          this.showSection("correct-answer-section");
          if (this.timer) {
            clearInterval(this.timer);
          }
          // Clear saved timer data and test progress when test is submitted
          this.safeLocalStorageSet("currentTestTimer", null);
          this.safeLocalStorageSet("currentTestProgress", null);
          this.generateCorrectAnswerInterface();
        }

        generateCorrectAnswerInterface() {
          const correctAnswerContainer = document.getElementById(
            "correct-answer-container",
          );
          if (!correctAnswerContainer) return;

          correctAnswerContainer.innerHTML = "";

          for (let i = 1; i <= this.testData.mcqNumber; i++) {
            const answerDiv = document.createElement("div");
            answerDiv.className =
              "flex flex-col md:flex-row md:items-center justify-between mb-4 md:mb-5 gap-2.5 md:gap-4 p-4 md:p-5 border border-white/30 rounded-xl bg-white/80 glass-morphism shadow-lg transition-all duration-300 hover:shadow-xl hover:-translate-y-0.5";

            const checkedA =
              this.retakeData && this.retakeData.correctAns[i - 1] === "A"
                ? "checked"
                : "";
            const checkedB =
              this.retakeData && this.retakeData.correctAns[i - 1] === "B"
                ? "checked"
                : "";
            const checkedC =
              this.retakeData && this.retakeData.correctAns[i - 1] === "C"
                ? "checked"
                : "";
            const checkedD =
              this.retakeData && this.retakeData.correctAns[i - 1] === "D"
                ? "checked"
                : "";

            answerDiv.innerHTML = `
              <p class="flex-1 md:mr-4 font-semibold text-gray-700 mb-2 md:mb-0 min-w-0 font-hind">
                <i class="fas fa-check-circle text-blue-600 mr-2" aria-hidden="true"></i>
                ‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶® ${i} ‡¶è‡¶∞ ‡¶∏‡¶†‡¶ø‡¶ï ‡¶â‡¶§‡ßç‡¶§‡¶∞:
              </p>
              <div class="flex gap-2 flex-wrap md:flex-nowrap items-center" role="radiogroup" aria-label="Correct answer for question ${i}">
                <input type="radio" name="correct-q${i}" value="A" class="radio-custom w-6 h-6 relative m-2 cursor-pointer appearance-none border-2 border-gray-300 rounded-full bg-white transition-all duration-300 hover:border-blue-600 hover:scale-105 focus:outline-2 focus:outline-blue-600 focus:outline-offset-2 min-w-[24px] flex-shrink-0" ${checkedA} aria-label="Correct answer A">
                <input type="radio" name="correct-q${i}" value="B" class="radio-custom w-6 h-6 relative m-2 cursor-pointer appearance-none border-2 border-gray-300 rounded-full bg-white transition-all duration-300 hover:border-blue-600 hover:scale-105 focus:outline-2 focus:outline-blue-600 focus:outline-offset-2 min-w-[24px] flex-shrink-0" ${checkedB} aria-label="Correct answer B">
                <input type="radio" name="correct-q${i}" value="C" class="radio-custom w-6 h-6 relative m-2 cursor-pointer appearance-none border-2 border-gray-300 rounded-full bg-white transition-all duration-300 hover:border-blue-600 hover:scale-105 focus:outline-2 focus:outline-blue-600 focus:outline-offset-2 min-w-[24px] flex-shrink-0" ${checkedC} aria-label="Correct answer C">
                <input type="radio" name="correct-q${i}" value="D" class="radio-custom w-6 h-6 relative m-2 cursor-pointer appearance-none border-2 border-gray-300 rounded-full bg-white transition-all duration-300 hover:border-blue-600 hover:scale-105 focus:outline-2 focus:outline-blue-600 focus:outline-offset-2 min-w-[24px] flex-shrink-0" ${checkedD} aria-label="Correct answer D">
              </div>
            `;
            correctAnswerContainer.appendChild(answerDiv);
          }

          this.setupCorrectAnswerValidation();
        }

        setupCorrectAnswerValidation() {
          const submitButton = document.getElementById(
            "submit-correct-answers",
          );
          const warningMessage = document.getElementById("warning-message");

          if (!submitButton || !warningMessage) return;

          const updateButtonState = () => {
            let allSelected = true;
            for (let i = 1; i <= this.testData.mcqNumber; i++) {
              const selected = document.querySelector(
                `input[name="correct-q${i}"]:checked`,
              );
              if (!selected) {
                allSelected = false;
                break;
              }
            }

            submitButton.disabled = !allSelected;
            submitButton.style.opacity = allSelected ? "1" : "0.5";
            warningMessage.style.display = allSelected ? "none" : "block";
          };
          for (let i = 1; i <= this.testData.mcqNumber; i++) {
            const radioButtons = document.querySelectorAll(
              `input[name="correct-q${i}"]`,
            );
            radioButtons.forEach((radio) => {
              radio.addEventListener("change", updateButtonState);
            });
          }

          updateButtonState();
        }
        submitCorrectAnswers() {
          this.showSection("result-section");
          this.calculateAndDisplayResults();
        }

        calculateAndDisplayResults() {
          const resultContainer = document.getElementById("result-container");
          if (!resultContainer) return;

          let correctCount = 0;
          let incorrectCount = 0;
          let skippedCount = 0;
          const userAnswers = [];
          const correctAnswers = [];

          for (let i = 1; i <= this.testData.mcqNumber; i++) {
            const userAnswer = document.querySelector(
              `input[name="q${i}"]:checked`,
            );
            const correctAnswer = document.querySelector(
              `input[name="correct-q${i}"]:checked`,
            );

            userAnswers.push(userAnswer ? userAnswer.value : "");
            correctAnswers.push(correctAnswer ? correctAnswer.value : "");

            if (!userAnswer) {
              skippedCount++;
            } else if (userAnswer && correctAnswer) {
              if (userAnswer.value === correctAnswer.value) {
                correctCount++;
              } else {
                incorrectCount++;
              }
            }
          }

          const totalScore =
            correctCount * this.testData.marksPerQuestion -
            incorrectCount * this.testData.negativeMarkingValue;
          const percentage = (correctCount / this.testData.mcqNumber) * 100;

          resultContainer.innerHTML = `
            <div class="bg-gradient-to-br from-green-50 to-green-100 border-2 border-green-500 p-4 md:p-6 rounded-xl shadow-xl">
              <h3 class="text-gray-800 font-bold mb-6 font-hind text-xl md:text-2xl text-center">
                <i class="fas fa-chart-pie text-blue-600 mr-2" aria-hidden="true"></i>
                ‡¶™‡¶∞‡ßÄ‡¶ï‡ßç‡¶∑‡¶æ‡¶∞ ‡¶´‡¶≤‡¶æ‡¶´‡¶≤
              </h3>
              <div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6 gap-2 sm:gap-3 md:gap-4 mb-4 sm:mb-6">
                <div class="bg-white/90 p-2 sm:p-3 md:p-4 rounded-lg shadow-md text-center">
                  <i class="fas fa-list text-blue-600 text-lg sm:text-xl md:text-2xl lg:text-3xl mb-1 sm:mb-2 block" aria-hidden="true"></i>
                  <div class="text-sm sm:text-base md:text-lg lg:text-xl xl:text-2xl font-bold text-blue-600">${
                    this.testData.mcqNumber
                  }</div>
                  <div class="font-semibold text-gray-700 font-hind text-xs sm:text-xs md:text-sm">‡¶Æ‡ßã‡¶ü ‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶®</div>
                </div>
                <div class="bg-white/90 p-2 sm:p-3 md:p-4 rounded-lg shadow-md text-center">
                  <i class="fas fa-check-circle text-green-600 text-lg sm:text-xl md:text-2xl lg:text-3xl mb-1 sm:mb-2 block" aria-hidden="true"></i>
                  <div class="text-sm sm:text-base md:text-lg lg:text-xl xl:text-2xl font-bold text-green-600">${correctCount}</div>
                  <div class="font-semibold text-gray-700 font-hind text-xs sm:text-xs md:text-sm">‡¶∏‡¶†‡¶ø‡¶ï ‡¶â‡¶§‡ßç‡¶§‡¶∞</div>
                </div>
                <div class="bg-white/90 p-2 sm:p-3 md:p-4 rounded-lg shadow-md text-center">
                  <i class="fas fa-times-circle text-red-600 text-lg sm:text-xl md:text-2xl lg:text-3xl mb-1 sm:mb-2 block" aria-hidden="true"></i>
                  <div class="text-sm sm:text-base md:text-lg lg:text-xl xl:text-2xl font-bold text-red-600">${incorrectCount}</div>
                  <div class="font-semibold text-gray-700 font-hind text-xs sm:text-xs md:text-sm">‡¶≠‡ßÅ‡¶≤ ‡¶â‡¶§‡ßç‡¶§‡¶∞</div>
                </div>
                <div class="bg-white/90 p-2 sm:p-3 md:p-4 rounded-lg shadow-md text-center">
                  <i class="fas fa-minus-circle text-orange-600 text-lg sm:text-xl md:text-2xl lg:text-3xl mb-1 sm:mb-2 block" aria-hidden="true"></i>
                  <div class="text-sm sm:text-base md:text-lg lg:text-xl xl:text-2xl font-bold text-orange-600">${skippedCount}</div>
                  <div class="font-semibold text-gray-700 font-hind text-xs sm:text-xs md:text-sm">‡¶¨‡¶æ‡¶¶ ‡¶¶‡ßá‡¶ì‡¶Ø‡¶º‡¶æ ‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶®</div>
                </div>
                <div class="bg-white/90 p-2 sm:p-3 md:p-4 rounded-lg shadow-md text-center">
                  <i class="fas fa-exclamation-triangle text-purple-600 text-lg sm:text-xl md:text-2xl lg:text-3xl mb-1 sm:mb-2 block" aria-hidden="true"></i>
                  <div class="text-sm sm:text-base md:text-lg lg:text-xl xl:text-2xl font-bold text-purple-600">${(
                    incorrectCount * this.testData.negativeMarkingValue
                  ).toFixed(2)}</div>
                  <div class="font-semibold text-gray-700 font-hind text-xs sm:text-xs md:text-sm">‡¶®‡ßá‡¶ó‡ßá‡¶ü‡¶ø‡¶≠ ‡¶Æ‡¶æ‡¶∞‡ßç‡¶ï‡¶ø‡¶Ç</div>
                </div>
                <div class="bg-white/90 p-2 sm:p-3 md:p-4 rounded-lg shadow-md text-center">
                  <i class="fas fa-trophy text-yellow-600 text-lg sm:text-xl md:text-2xl lg:text-3xl mb-1 sm:mb-2 block" aria-hidden="true"></i>
                  <div class="text-sm sm:text-base md:text-lg lg:text-xl xl:text-2xl font-bold text-yellow-600">${totalScore.toFixed(
                    2,
                  )}</div>
                  <div class="font-semibold text-gray-700 font-hind text-xs sm:text-xs md:text-sm">‡¶Æ‡ßã‡¶ü ‡¶∏‡ßç‡¶ï‡ßã‡¶∞</div>
                </div>
              </div>
              <div class="bg-gradient-to-r from-orange-100 to-orange-200 border-2 border-orange-300 p-2 sm:p-3 md:p-4 rounded-xl text-center">
                <div class="text-lg sm:text-xl md:text-2xl lg:text-3xl xl:text-4xl font-bold text-orange-700 mb-1 sm:mb-2">
                  <i class="fas fa-percentage mr-1 sm:mr-2 text-sm sm:text-base md:text-lg" aria-hidden="true"></i> ${percentage.toFixed(
                    2,
                  )}%
                </div>
                <div class="text-sm sm:text-base md:text-lg font-semibold text-orange-800 font-hind">‡¶∏‡¶æ‡¶∞‡ßç‡¶¨‡¶ø‡¶ï ‡¶∂‡¶§‡¶æ‡¶Ç‡¶∂</div>
              </div>
            </div>
          `;
          this.currentResults = {
            userAnswers,
            correctAnswers,
            totalScore,
            percentage,
          };
        }
        saveTest() {
          if (!this.currentResults) {
            alert("‡¶ï‡ßã‡¶® ‡¶´‡¶≤‡¶æ‡¶´‡¶≤ ‡¶®‡ßá‡¶á ‡¶∏‡ßá‡¶≠ ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø‡•§");
            return;
          }

          const testData = {
            name: this.testData.name,
            totalQ: this.testData.mcqNumber,
            marksPerQ: this.testData.marksPerQuestion,
            negMark: this.testData.negativeMarkingValue,
            timeLim: this.testData.timeLimit,
            userAns: this.currentResults.userAnswers,
            correctAns: this.currentResults.correctAnswers,
            date: new Date().toISOString(),
          };

          const tests = this.safeLocalStorageGet("examHistory", []);
          tests.push(testData);

          if (this.safeLocalStorageSet("examHistory", tests)) {
            alert("‡¶™‡¶∞‡ßÄ‡¶ï‡ßç‡¶∑‡¶æ ‡¶∏‡ßá‡¶≠ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá!");
          }
        }

        loadHistory() {
          const tests = this.safeLocalStorageGet("examHistory", []);
          const container = document.getElementById("history-container");

          if (!container) return;

          container.innerHTML = "";

          if (tests.length === 0) {
            container.innerHTML =
              '<p class="text-center text-gray-600">‡¶ï‡ßã‡¶® ‡¶™‡¶∞‡ßÄ‡¶ï‡ßç‡¶∑‡¶æ ‡¶∏‡ßá‡¶≠ ‡¶π‡¶Ø‡¶º‡¶®‡¶ø‡•§</p>';
            return;
          }

          tests.forEach((test, index) => {
            const div = document.createElement("div");
            div.className = "bg-white/80 p-4 rounded-lg shadow-md mb-4";
            div.innerHTML = `
              <h3 class="font-bold text-lg">${this.escapeHtml(test.name)}</h3>
              <p>‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ: ${new Date(test.date).toLocaleString()}</p>
              <p>‡¶Æ‡ßã‡¶ü ‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶®: ${test.totalQ}, ‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶® ‡¶™‡ßç‡¶∞‡¶§‡¶ø ‡¶®‡¶æ‡¶Æ‡ßç‡¶¨‡¶æ‡¶∞: ${
                test.marksPerQ
              }, ‡¶®‡ßá‡¶ó‡ßá‡¶ü‡¶ø‡¶≠ ‡¶Æ‡¶æ‡¶∞‡ßç‡¶ï‡¶ø‡¶Ç: ${test.negMark}, ‡¶∏‡¶Æ‡¶Ø‡¶º: ${test.timeLim} ‡¶Æ‡¶ø‡¶®‡¶ø‡¶ü</p>
              <button class="mt-2 px-4 py-2 bg-blue-500 text-white rounded mr-2 retake-btn" data-index="${index}" aria-label="Retake test ${
                index + 1
              }">‡¶™‡ßÅ‡¶®‡¶∞‡¶æ‡¶Ø‡¶º ‡¶®‡ßá‡¶ì‡¶Ø‡¶º‡¶æ</button>
              <button class="mt-2 px-4 py-2 bg-red-500 text-white rounded delete-btn" data-index="${index}" aria-label="Delete test ${
                index + 1
              }">‡¶°‡¶ø‡¶≤‡¶ø‡¶ü</button>
            `;
            container.appendChild(div);
          });
          container.querySelectorAll(".retake-btn").forEach((btn) => {
            btn.addEventListener("click", (e) => {
              const index = parseInt(e.target.dataset.index);
              this.retakeTest(index);
            });
          });

          container.querySelectorAll(".delete-btn").forEach((btn) => {
            btn.addEventListener("click", (e) => {
              const index = parseInt(e.target.dataset.index);
              this.deleteTest(index);
            });
          });
        }

        deleteTest(index) {
          const tests = this.safeLocalStorageGet("examHistory", []);
          if (index >= 0 && index < tests.length) {
            tests.splice(index, 1);
            this.safeLocalStorageSet("examHistory", tests);
            this.loadHistory();
          }
        }

        retakeTest(index) {
          const tests = this.safeLocalStorageGet("examHistory", []);
          const test = tests[index];

          if (!test) return;

          this.retakeData = test;
          this.testData = {
            name: test.name,
            mcqNumber: test.totalQ,
            marksPerQuestion: test.marksPerQ,
            negativeMarkingValue: test.negMark,
            timeLimit: test.timeLim,
          };
          document.getElementById("test-name").value = test.name;
          document.getElementById("mcq-number").value = test.totalQ;
          document.getElementById("marks-per-question").value = test.marksPerQ;
          document.getElementById("negative-marking-value").value =
            test.negMark;
          document.getElementById("time-limit").value = test.timeLim;
          this.showSection("test-section");
          this.generateTestInterface();
          this.startTimer();
        }
        saveTestProgress() {
          const answers = {};
          for (let i = 1; i <= this.testData.mcqNumber; i++) {
            const selectedAnswer = document.querySelector(
              `input[name="q${i}"]:checked`,
            );
            answers[i] = selectedAnswer ? selectedAnswer.value : "";
          }

          const progressData = {
            testName: this.testData.name,
            answers: answers,
            timestamp: Date.now(),
          };

          // Show auto-save indicator
          const indicator = document.getElementById("auto-save-indicator");
          if (indicator) {
            indicator.style.display = "flex";
          }

          this.safeLocalStorageSet("currentTestProgress", progressData);

          // Hide indicator after a short delay
          setTimeout(() => {
            if (indicator) {
              indicator.style.display = "none";
            }
          }, 1000);
        }

        handleFormSubmit(event) {
          event.preventDefault();

          try {
            // Clear previous error styles
            this.clearFormErrors();

            // Validate and collect form data
            const formData = this.validateFormData();
            if (!formData) return; // Validation failed

            this.testData = formData;
            this.showSection("test-section");
            this.generateTestInterface();
            this.startTimer();
          } catch (error) {
            console.error("Form submission error:", error);
            this.showError("‡¶´‡¶∞‡ßç‡¶Æ ‡¶ú‡¶Æ‡¶æ ‡¶¶‡ßá‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞ ‡¶∏‡¶Æ‡¶Ø‡¶º ‡¶è‡¶ï‡¶ü‡¶ø ‡¶§‡ßç‡¶∞‡ßÅ‡¶ü‡¶ø ‡¶ò‡¶ü‡ßá‡¶õ‡ßá‡•§");
          }
        }

        clearFormErrors() {
          const inputs = document.querySelectorAll("#test-form input");
          inputs.forEach((input) => {
            input.classList.remove("border-red-500");
            const errorDiv =
              input.parentElement.querySelector(".error-message");
            if (errorDiv) errorDiv.remove();
          });
        }

        showFieldError(fieldId, message) {
          const field = document.getElementById(fieldId);
          if (!field) return;

          field.classList.add("border-red-500");
          const errorDiv = document.createElement("div");
          errorDiv.className =
            "error-message text-red-600 text-sm mt-1 font-hind";
          errorDiv.textContent = message;
          field.parentElement.appendChild(errorDiv);
          field.focus();
        }

        showError(message) {
          alert(message);
        }

        validateFormData() {
          const name = document.getElementById("test-name").value.trim();
          const mcqNumber = document.getElementById("mcq-number").value.trim();
          const timeLimit = document.getElementById("time-limit").value.trim();
          const marksPerQuestion = document
            .getElementById("marks-per-question")
            .value.trim();
          const negativeMarkingValue = document
            .getElementById("negative-marking-value")
            .value.trim();

          // Test name validation
          if (!name) {
            this.showFieldError("test-name", "‡¶™‡¶∞‡ßÄ‡¶ï‡ßç‡¶∑‡¶æ‡¶∞ ‡¶®‡¶æ‡¶Æ ‡¶Ö‡¶¨‡¶∂‡ßç‡¶Ø‡¶á ‡¶¶‡¶ø‡¶§‡ßá ‡¶π‡¶¨‡ßá‡•§");
            return null;
          }
          if (name.length < 2) {
            this.showFieldError(
              "test-name",
              "‡¶™‡¶∞‡ßÄ‡¶ï‡ßç‡¶∑‡¶æ‡¶∞ ‡¶®‡¶æ‡¶Æ ‡¶ï‡¶Æ‡¶™‡¶ï‡ßç‡¶∑‡ßá ‡ß®‡¶ü‡¶ø ‡¶Ö‡¶ï‡ßç‡¶∑‡¶∞ ‡¶π‡¶§‡ßá ‡¶π‡¶¨‡ßá‡•§",
            );
            return null;
          }
          if (name.length > 100) {
            this.showFieldError(
              "test-name",
              "‡¶™‡¶∞‡ßÄ‡¶ï‡ßç‡¶∑‡¶æ‡¶∞ ‡¶®‡¶æ‡¶Æ ‡¶∏‡¶∞‡ßç‡¶¨‡ßã‡¶ö‡ßç‡¶ö ‡ßß‡ß¶‡ß¶ ‡¶Ö‡¶ï‡ßç‡¶∑‡¶∞ ‡¶π‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡ßá‡•§",
            );
            return null;
          }

          // MCQ number validation
          if (!mcqNumber) {
            this.showFieldError(
              "mcq-number",
              "‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶®‡ßá‡¶∞ ‡¶∏‡¶Ç‡¶ñ‡ßç‡¶Ø‡¶æ ‡¶Ö‡¶¨‡¶∂‡ßç‡¶Ø‡¶á ‡¶¶‡¶ø‡¶§‡ßá ‡¶π‡¶¨‡ßá‡•§",
            );
            return null;
          }
          const parsedMcqNumber = parseInt(mcqNumber);
          if (isNaN(parsedMcqNumber) || parsedMcqNumber < 1) {
            this.showFieldError(
              "mcq-number",
              "‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶®‡ßá‡¶∞ ‡¶∏‡¶Ç‡¶ñ‡ßç‡¶Ø‡¶æ ‡¶ï‡¶Æ‡¶™‡¶ï‡ßç‡¶∑‡ßá ‡ßß ‡¶π‡¶§‡ßá ‡¶π‡¶¨‡ßá‡•§",
            );
            return null;
          }
          if (parsedMcqNumber > 100) {
            this.showFieldError(
              "mcq-number",
              "‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶®‡ßá‡¶∞ ‡¶∏‡¶Ç‡¶ñ‡ßç‡¶Ø‡¶æ ‡¶∏‡¶∞‡ßç‡¶¨‡ßã‡¶ö‡ßç‡¶ö ‡ßß‡ß¶‡ß¶ ‡¶π‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡ßá‡•§",
            );
            return null;
          }

          // Time limit validation
          if (!timeLimit) {
            this.showFieldError("time-limit", "‡¶∏‡¶Æ‡¶Ø‡¶º‡¶∏‡ßÄ‡¶Æ‡¶æ ‡¶Ö‡¶¨‡¶∂‡ßç‡¶Ø‡¶á ‡¶¶‡¶ø‡¶§‡ßá ‡¶π‡¶¨‡ßá‡•§");
            return null;
          }
          const parsedTimeLimit = parseInt(timeLimit);
          if (isNaN(parsedTimeLimit) || parsedTimeLimit < 1) {
            this.showFieldError(
              "time-limit",
              "‡¶∏‡¶Æ‡¶Ø‡¶º‡¶∏‡ßÄ‡¶Æ‡¶æ ‡¶ï‡¶Æ‡¶™‡¶ï‡ßç‡¶∑‡ßá ‡ßß ‡¶Æ‡¶ø‡¶®‡¶ø‡¶ü ‡¶π‡¶§‡ßá ‡¶π‡¶¨‡ßá‡•§",
            );
            return null;
          }
          if (parsedTimeLimit > 300) {
            this.showFieldError(
              "time-limit",
              "‡¶∏‡¶Æ‡¶Ø‡¶º‡¶∏‡ßÄ‡¶Æ‡¶æ ‡¶∏‡¶∞‡ßç‡¶¨‡ßã‡¶ö‡ßç‡¶ö ‡ß©‡ß¶‡ß¶ ‡¶Æ‡¶ø‡¶®‡¶ø‡¶ü ‡¶π‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡ßá‡•§",
            );
            return null;
          }

          // Marks per question validation
          if (!marksPerQuestion) {
            this.showFieldError(
              "marks-per-question",
              "‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶® ‡¶™‡ßç‡¶∞‡¶§‡¶ø ‡¶®‡¶æ‡¶Æ‡ßç‡¶¨‡¶æ‡¶∞ ‡¶Ö‡¶¨‡¶∂‡ßç‡¶Ø‡¶á ‡¶¶‡¶ø‡¶§‡ßá ‡¶π‡¶¨‡ßá‡•§",
            );
            return null;
          }
          const parsedMarksPerQuestion = parseFloat(marksPerQuestion);
          if (isNaN(parsedMarksPerQuestion) || parsedMarksPerQuestion < 0) {
            this.showFieldError(
              "marks-per-question",
              "‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶® ‡¶™‡ßç‡¶∞‡¶§‡¶ø ‡¶®‡¶æ‡¶Æ‡ßç‡¶¨‡¶æ‡¶∞ ‡ß¶ ‡¶¨‡¶æ ‡¶§‡¶æ‡¶∞ ‡¶¨‡ßá‡¶∂‡¶ø ‡¶π‡¶§‡ßá ‡¶π‡¶¨‡ßá‡•§",
            );
            return null;
          }
          if (parsedMarksPerQuestion > 10) {
            this.showFieldError(
              "marks-per-question",
              "‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶® ‡¶™‡ßç‡¶∞‡¶§‡¶ø ‡¶®‡¶æ‡¶Æ‡ßç‡¶¨‡¶æ‡¶∞ ‡¶∏‡¶∞‡ßç‡¶¨‡ßã‡¶ö‡ßç‡¶ö ‡ßß‡ß¶ ‡¶π‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡ßá‡•§",
            );
            return null;
          }

          // Negative marking validation
          if (!negativeMarkingValue) {
            this.showFieldError(
              "negative-marking-value",
              "‡¶®‡ßá‡¶ó‡ßá‡¶ü‡¶ø‡¶≠ ‡¶Æ‡¶æ‡¶∞‡ßç‡¶ï‡¶ø‡¶Ç ‡¶Æ‡¶æ‡¶® ‡¶Ö‡¶¨‡¶∂‡ßç‡¶Ø‡¶á ‡¶¶‡¶ø‡¶§‡ßá ‡¶π‡¶¨‡ßá‡•§",
            );
            return null;
          }
          const parsedNegativeMarking = parseFloat(negativeMarkingValue);
          if (isNaN(parsedNegativeMarking) || parsedNegativeMarking < 0) {
            this.showFieldError(
              "negative-marking-value",
              "‡¶®‡ßá‡¶ó‡ßá‡¶ü‡¶ø‡¶≠ ‡¶Æ‡¶æ‡¶∞‡ßç‡¶ï‡¶ø‡¶Ç ‡¶Æ‡¶æ‡¶® ‡ß¶ ‡¶¨‡¶æ ‡¶§‡¶æ‡¶∞ ‡¶¨‡ßá‡¶∂‡¶ø ‡¶π‡¶§‡ßá ‡¶π‡¶¨‡ßá‡•§",
            );
            return null;
          }
          if (parsedNegativeMarking > parsedMarksPerQuestion) {
            this.showFieldError(
              "negative-marking-value",
              "‡¶®‡ßá‡¶ó‡ßá‡¶ü‡¶ø‡¶≠ ‡¶Æ‡¶æ‡¶∞‡ßç‡¶ï‡¶ø‡¶Ç ‡¶Æ‡¶æ‡¶® ‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶® ‡¶™‡ßç‡¶∞‡¶§‡¶ø ‡¶®‡¶æ‡¶Æ‡ßç‡¶¨‡¶æ‡¶∞‡ßá‡¶∞ ‡¶ö‡ßá‡¶Ø‡¶º‡ßá ‡¶¨‡ßá‡¶∂‡¶ø ‡¶π‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡ßá ‡¶®‡¶æ‡•§",
            );
            return null;
          }

          return {
            name: name,
            mcqNumber: parsedMcqNumber,
            timeLimit: parsedTimeLimit,
            marksPerQuestion: parsedMarksPerQuestion,
            negativeMarkingValue: parsedNegativeMarking,
          };
        }

        setupEventListeners() {
          this.addEventListener("test-form", "submit", (e) =>
            this.handleFormSubmit(e),
          );
          this.addEventListener("view-history", "click", () => {
            this.showSection("history-section");
            this.loadHistory();
          });

          this.addEventListener("back-to-home", "click", () => {
            this.showSection("configuration-section");
          });
          this.addEventListener("submit-test", "click", () =>
            this.submitTest(),
          );
          this.addEventListener("submit-correct-answers", "click", () =>
            this.submitCorrectAnswers(),
          );
          this.addEventListener("save-test", "click", () => this.saveTest());

          this.addEventListener("print-result", "click", () => window.print());

          this.addEventListener("restart-btn", "click", () => {
            if (this.timer) {
              clearInterval(this.timer);
            }
            this.retakeData = null;
            // Clear saved timer data and test progress when restarting
            this.safeLocalStorageSet("currentTestTimer", null);
            this.safeLocalStorageSet("currentTestProgress", null);
            this.showSection("configuration-section");
            document.getElementById("test-form").reset();
            document.getElementById("correct-answer-container").innerHTML = "";
            document.getElementById("mcq-container").innerHTML = "";
            document.getElementById("result-container").innerHTML = "";
          });
        }
      }
      document.addEventListener("DOMContentLoaded", () => {
        const hiddenSections = [
          "test-section",
          "correct-answer-section",
          "result-section",
          "history-section",
        ];
        hiddenSections.forEach((id) => {
          const element = document.getElementById(id);
          if (element && element.classList.contains("hidden")) {
            element.setAttribute("aria-hidden", "true");
          }
        });

        new ExamApp();
      });
    </script>
    <script>
      // Enhanced utility functions
      function escapeHtml(text) {
        const map = {
          "&": "&amp;",
          "<": "&lt;",
          ">": "&gt;",
          '"': "&quot;",
          "'": "&#039;",
        };
        return text.replace(/[&<>"']/g, function (m) {
          return map[m];
        });
      }

      // Professional enhancement functions
      function applyProfessionalEnhancements() {
        // Add professional classes to buttons
        const buttons = document.querySelectorAll("button:not(.no-enhance)");
        buttons.forEach((btn) => {
          btn.classList.add("btn-professional");
        });

        // Add professional classes to inputs
        const inputs = document.querySelectorAll("input, select, textarea");
        inputs.forEach((input) => {
          input.classList.add("input-professional");
        });

        // Add card hover effects
        const cards = document.querySelectorAll(
          ".bg-white, .rounded-xl, .shadow-xl",
        );
        cards.forEach((card) => {
          card.classList.add("card-hover");
        });

        // Add fade-in animation to main sections
        const sections = document.querySelectorAll("section");
        sections.forEach((section, index) => {
          section.style.animation = `fadeInUp 0.6s ease forwards ${index * 0.1}s`;
        });

        // Add professional notifications
        addNotificationSystem();

        // Add loading states
        addLoadingStates();

        // Add enhanced progress indicators
        enhanceProgressIndicators();

        // Add status indicators where appropriate
        addStatusIndicators();
      }

      function addNotificationSystem() {
        // Create notification container if it doesn't exist
        if (!document.getElementById("notification-container")) {
          const container = document.createElement("div");
          container.id = "notification-container";
          container.className = "fixed top-4 right-4 z-50 space-y-2";
          document.body.appendChild(container);
        }
      }

      function showNotification(message, type = "info", duration = 3000) {
        const container = document.getElementById("notification-container");
        if (!container) return;

        const notification = document.createElement("div");
        notification.className = `notification-slide p-4 rounded-lg shadow-lg text-white max-w-sm ${
          type === "success"
            ? "bg-green-500"
            : type === "error"
              ? "bg-red-500"
              : type === "warning"
                ? "bg-yellow-500"
                : "bg-blue-500"
        }`;

        const statusIcon = document.createElement("span");
        statusIcon.className = `status-indicator status-${type}`;

        notification.innerHTML = `
          <div class="flex items-center">
            ${statusIcon.outerHTML}
            <span>${message}</span>
          </div>
        `;

        container.appendChild(notification);

        // Auto-remove after duration
        setTimeout(() => {
          notification.classList.add("hide");
          setTimeout(() => {
            if (container.contains(notification)) {
              container.removeChild(notification);
            }
          }, 300);
        }, duration);
      }

      function addLoadingStates() {
        // Add loading shimmer to elements that might load dynamically
        const loadingElements = document.querySelectorAll(".async-content");
        loadingElements.forEach((el) => {
          if (!el.dataset.loaded) {
            el.classList.add("loading-shimmer");
          }
        });
      }

      function enhanceProgressIndicators() {
        // Enhance any progress bars or indicators
        const progressElements = document.querySelectorAll(
          '.progress, [role="progressbar"]',
        );
        progressElements.forEach((progress) => {
          if (!progress.querySelector(".progress-ring")) {
            progress.style.transition = "all 0.5s cubic-bezier(0.4, 0, 0.2, 1)";
          }
        });
      }

      function addStatusIndicators() {
        // Add status indicators to important elements
        const statusElements = document.querySelectorAll(
          ".status, .result, .score",
        );
        statusElements.forEach((el) => {
          if (!el.querySelector(".status-indicator")) {
            const indicator = document.createElement("span");
            indicator.className = "status-indicator status-info";
            el.insertBefore(indicator, el.firstChild);
          }
        });
      }

      // Global notification function for use throughout the app
      window.showNotification = showNotification;

      // Initialize the app only once
      document.addEventListener("DOMContentLoaded", () => {
        const hiddenSections = [
          "test-section",
          "correct-answer-section",
          "result-section",
          "history-section",
        ];
        hiddenSections.forEach((id) => {
          const element = document.getElementById(id);
          if (element && element.classList.contains("hidden")) {
            element.setAttribute("aria-hidden", "true");
          }
        });

        const app = new ExamApp();
        window.examAppInstance = app; // Store globally for export/import buttons

        // Apply professional enhancements
        applyProfessionalEnhancements();

        // Add event listeners for export/import buttons
        setTimeout(() => {
          const exportBtn = document.getElementById("export-data");
          const importBtn = document.getElementById("import-data");

          if (exportBtn) {
            exportBtn.addEventListener("click", () => {
              if (window.examAppInstance) {
                window.examAppInstance.exportData();
              } else {
                console.error("Exam app instance not found");
              }
            });
          }

          if (importBtn) {
            importBtn.addEventListener("click", () => {
              if (window.examAppInstance) {
                window.examAppInstance.importData();
              } else {
                console.error("Exam app instance not found");
              }
            });
          }
        }, 100);
      });
    </script>
  </body>
</html>
